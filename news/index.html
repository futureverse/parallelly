<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • parallelly</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://parallelly.futureverse.org/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SB3EQSD9FR"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SB3EQSD9FR');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parallelly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.45.0-9016</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/parallelly-01-intro.html">An Introduction to 'parallelly'</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-10-local-workers.html">Parallel Workers on the Local Machine</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-12-remote-workers.html">Parallel Workers on Other Machines</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-15-cloud-workers.html">Parallel Workers in the Cloud</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-17-hpc-workers.html">Parallel Workers on High-Performance Compute Environments</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-20-limit-workers.html">Parallel Workers with CPU and Memory Limited</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-21-container-workers.html">Parallel Workers Running in Linux Containers</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-22-wine-workers.html">Parallel Workers Running MS Windows via Wine</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.futureverse.org/"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><a class="external-link dropdown-item" href="https://doFuture.futureverse.org">doFuture (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://furrr.futureverse.org">furrr (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.futureverse.org">future</a></li>
    <li><a class="external-link dropdown-item" href="https://future.apply.futureverse.org">future.apply (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.batchtools.futureverse.org">future.batchtools (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.callr.futureverse.org">future.callr (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mirai.futureverse.org">future.mirai (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tests.futureverse.org">future.tests</a></li>
    <li><a class="external-link dropdown-item" href="https://globals.futureverse.org">globals</a></li>
    <li><a class="external-link dropdown-item" href="https://listenv.futureverse.org">listenv</a></li>
    <li><a class="dropdown-item" href="https://parallelly.futureverse.org">parallelly</a></li>
    <li><a class="external-link dropdown-item" href="https://progressr.futureverse.org">progressr</a></li>
    <li><a class="external-link dropdown-item" href="https://BiocParallel.FutureParam.futureverse.org">BiocParallel.FutureParam (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tools.futureverse.org">future.tools (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mapreduce.futureverse.org">future.mapreduce (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://marshal.futureverse.org">marshal (experimental)</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cloud.r-project.org/package=parallelly"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/futureverse/parallelly/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/futureverse/parallelly/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="development version" id="version-development-version">Version (development version)<a class="anchor" aria-label="anchor" href="#version-development-version"></a></h2>
<div class="section level3">
<h3 id="new-features-development-version">New Features<a class="anchor" aria-label="anchor" href="#new-features-development-version"></a></h3>
<ul><li>Now <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> for <code>RichSOCKcluster</code> outputs a more concise summary, which is also grammatically correct for single-node clusters.</li>
</ul></div>
<div class="section level3">
<h3 id="deprecated-and-defunct-development-version">Deprecated and Defunct<a class="anchor" aria-label="anchor" href="#deprecated-and-defunct-development-version"></a></h3>
<ul><li>In previous version, <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> started to collect session information on each parallel worker, which included <code><a href="https://rdrr.io/r/base/capabilities.html" class="external-link">capabilities()</a></code>. However, for unknown reasons, <code><a href="https://rdrr.io/r/base/capabilities.html" class="external-link">capabilities()</a></code> caused the cluster creation to fail GitHub Actions running macOS. The problem could be reproduced neither locally, on the mac-builder, nor on the CRAN macOS servers. Because this feature is non-critical and only introduced in the previous version, I decided to remove the collection of <code><a href="https://rdrr.io/r/base/capabilities.html" class="external-link">capabilities()</a></code> again.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.45.0" id="version-1450">Version 1.45.0<a class="anchor" aria-label="anchor" href="#version-1450"></a></h2><p class="text-muted">CRAN release: 2025-06-02</p>
<div class="section level3">
<h3 id="new-features-1-45-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-45-0"></a></h3>
<ul><li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> gained argument <code>max</code>, which limits the maximum number of cores returned after everything else is applied, i.e. <code>availableCores(..., max = n)</code> is short for <code>min(n,    availableCores(...), na.rm = TRUE)</code>.</p></li>
<li><p><code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> gained argument <code>...</code>, which passes any additional arguments to <code><a href="../reference/availableCores.html">availableCores()</a></code>, if specified.</p></li>
<li><p>If <code>killNode(..., signal = tools::SIGTERM)</code> successfully signaled the cluster node, it will now close any existing socket connection to the node. If the node is running on the local host, it will also remove its temporary directory, because the the node’s R process might not have been exited gracefully.</p></li>
<li><p>The session information collected by <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now contains more details on each worker, e.g. the <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code> folder, <code><a href="https://rdrr.io/r/base/capabilities.html" class="external-link">capabilities()</a></code>, and <code><a href="https://rdrr.io/r/base/extSoftVersion.html" class="external-link">extSoftVersion()</a></code>.</p></li>
<li><p>Cluster nodes created by <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained attribute <code>calls</code>, which records the <code><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">sys.calls()</a></code>. This can be useful when troubleshooting from where a cluster was created. Analogously, setting R option <code>parallelly.makeNodePSOCK.calls</code> to TRUE will relay the call stack in the system call that launched the cluster node.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-45-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-45-0"></a></h3>
<ul><li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> would not respect <code>method = "fallback"</code> if <code>constraints</code> specified <code>"connections"</code> or <code>"connections-N"</code>.</p></li>
<li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> would produce an error on <code>Error in scan(file =    file, what = what, ...)</code> on systems that have a <code>/proc/self/mounts</code> file with syntax errors. Such files have been reported on Windows Subsystem for Linux version 2 (WSL 2), where spaces in Windows path have not been properly escaped for some entries. Now such invalid entries are skipped, before parsing the mount table.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.44.0" id="version-1440">Version 1.44.0<a class="anchor" aria-label="anchor" href="#version-1440"></a></h2><p class="text-muted">CRAN release: 2025-05-07</p>
<div class="section level3">
<h3 id="new-features-1-44-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-44-0"></a></h3>
<ul><li><p>Add support to <code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> to specify <code>constraints = "connections-N"</code>, where <code>N</code> specifies the number of connections to leave free after launching a PSOCK cluster with this number of cores.</p></li>
<li><p>Add <code><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal()</a></code> for <code>connection</code>, which can distinguish between two connections that share the same connection index, but are not the same connection, e.g. when one was created, then closed, and another one of the same kind is created.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-44-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-44-0"></a></h3>
<ul><li>
<code><a href="../reference/availableCores.html">availableCores()</a></code> would not respect <code>method = "fallback"</code>, since v1.41.0 (2024-12-18), on system with a value for <code>method =    "/proc/self/status"</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.43.0" id="version-1430">Version 1.43.0<a class="anchor" aria-label="anchor" href="#version-1430"></a></h2><p class="text-muted">CRAN release: 2025-03-24</p>
<div class="section level3">
<h3 id="significant-changes-1-43-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-43-0"></a></h3>
<ul><li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> memoizes the values of all its components. This means that as soon as it has been called, environment variables such as <code>NSLOTS</code> will no longer be queried.</p></li>
<li><p>Starting with R 4.5.0, one can use <code>parallel::makeCluster(n, type =    parallelly::RPSOCK)</code> as an alternative to <code>parallelly::makeClusterPSOCK(n)</code>. Similarly, <code>type =    parallelly::RMPI</code> creates a cluster using <code><a href="../reference/makeClusterMPI.html">parallelly::makeClusterMPI()</a></code>, and <code>type = parallelly::SEQ</code> creates a cluster using <code><a href="../reference/makeClusterSequential.html">parallelly::makeClusterSequential()</a></code>. This was first introduced in <strong>parallelly</strong> 1.38.0, but here we rename <code>PSOCK</code> to <code>RPSOCK</code> and <code>MPI</code> to <code>RMPI</code> to minimize the risk for mistaking them from the built-in types in the <strong>parallel</strong> package. The <code>R</code> stands for “Rich”.</p></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-43-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-43-0"></a></h3>
<ul><li>Add more help on the R option <code>parallelly.maxWorkers.localhost</code> limits. Improved the warning and error messages that are produced when these settings are exceeded.</li>
</ul></div>
<div class="section level3">
<h3 id="miscellaneous-1-43-0">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-1-43-0"></a></h3>
<ul><li>R option <code>future.debug</code> is no longer used as a fallback for option <code>parallelly.debug</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-43-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-43-0"></a></h3>
<ul><li><p><code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> could produce warnings on <code>doTryCatch(return(expr),    name, parentenv, handler) : NAs introduced by coercion</code> on MS Windows. Improved the internal <code>tasklist</code> parses used to test whether a process is alive.</p></li>
<li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> could produce <code>Error: Error in    cache_controller[[field]] : subscript out of bounds</code> in <code>... getCGroups1CpuQuota -&gt; getCGroups1CpuPeriodMicroseconds</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.42.0" id="version-1420">Version 1.42.0<a class="anchor" aria-label="anchor" href="#version-1420"></a></h2><p class="text-muted">CRAN release: 2025-01-30</p>
<div class="section level3">
<h3 id="new-features-1-42-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-42-0"></a></h3>
<ul><li>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> support also when both CGroups v1 and CGroups v2 are enabled on the machine. Previously, such configurations were completely ignored.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-42-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-42-0"></a></h3>
<ul><li><p>Call <code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> and <code><a href="../reference/killNode.html">killNode()</a></code> on cluster nodes running on external machines would produce <code>Error in match.arg(type, choices =    known_types, several.ok = FALSE) : 'arg' must be of length 1</code>. This bug was introduced in version 1.38.0 (2024-07-27), when adding richer support for the <code>rscript_sh</code> argument.</p></li>
<li><p>Call <code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> and <code><a href="../reference/killNode.html">killNode()</a></code> on cluster nodes running on external machines would produce <code>Error: ‘length(rsh_call) == 1L’ is    not TRUE</code> if option <code>rshopts</code> were specified during creation.</p></li>
<li><p>The value of <code><a href="../reference/availableCores.html">availableCores()</a></code> was numeric rather than integer as documented. This harmless bug was introduced in version 1.31.0 (2022-04-07).</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.41.0" id="version-1410">Version 1.41.0<a class="anchor" aria-label="anchor" href="#version-1410"></a></h2><p class="text-muted">CRAN release: 2024-12-18</p>
<div class="section level3">
<h3 id="new-features-1-41-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-41-0"></a></h3>
<ul><li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> queries also <code>/proc/self/status</code> for CPU affinity allotments.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> will now produce an error, rather than a warning, when the local system command used to launch the parallel worker failed with a non-zero exit code.</p></li>
<li><p>Now <code><a href="../reference/serializedSize.html">serializedSize()</a></code> always returns a double. Previously, it would return an integer, if the value could be represented by an integer. However, it turned out that returning an integer increased the risk for integer overflow later on if, say, two such values were added together.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-41-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-41-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> on MS Windows failed to launch remote workers, with warnings on <code>"In system(local_cmd, wait = FALSE, input =    input) : 'C:\WINDOWS\System32\OpenSSH\ssh.exe' not found"</code>. This bug was introduced in version 1.38.0 (2024-07-27), when adding richer support for the <code>rscript_sh</code> argument.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.40.1" id="version-1401">Version 1.40.1<a class="anchor" aria-label="anchor" href="#version-1401"></a></h2><p class="text-muted">CRAN release: 2024-12-04</p>
<div class="section level3">
<h3 id="bug-fixes-1-40-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-40-1"></a></h3>
<ul><li>The internal vignette engine wrote files to user’s home directory. They were due to a brief debugging of the vignette engine and then forgotten about.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.40.0" id="version-1400">Version 1.40.0<a class="anchor" aria-label="anchor" href="#version-1400"></a></h2><p class="text-muted">CRAN release: 2024-12-03</p>
<div class="section level3">
<h3 id="new-features-1-40-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-40-0"></a></h3>
<ul><li>Argument <code>user</code> of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> may now be a vector of usernames - one for each worker specified.</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-40-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-40-0"></a></h3>
<ul><li>Add vignettes on how to setup a cluster of parallel workers on the local machine, on external machines, in the cloud, in HPC environments, and more.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-40-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-40-0"></a></h3>
<ul><li><p>Querying of cgroups v1 ‘cpuquota’ CPU limits broke in the previous release (v1.39.0).</p></li>
<li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> could produce error <code>Failed to identify mount    point for CGroups v1 controller 'cpuset'</code> on some systems.</p></li>
<li><p><code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> would produce invalid warning on <code>Identified 8    workers from the ‘PE_HOSTFILE’ file (...), which is more than    environment variable ‘NSLOTS’ = 8</code> when running via a Grid Engine job scheduler.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.39.0" id="version-1390">Version 1.39.0<a class="anchor" aria-label="anchor" href="#version-1390"></a></h2><p class="text-muted">CRAN release: 2024-11-07</p>
<div class="section level3">
<h3 id="new-features-1-39-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-39-0"></a></h3>
<ul><li>Environment variables <code>R_PARALLELLY_RANDOM_PORTS</code> now supports multiple, comma-separated port specifications, e.g. <code>"20001:20999"</code> and <code>"1068:1099,20001:20999,40530"</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-39-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-39-0"></a></h3>
<ul><li>Add example to <code><a href="../reference/makeClusterPSOCK.html">help("makeClusterPSOCK")</a></code> on how to use <code>systemd-run</code> to limit workers’ CPU quota and memory allowances.</li>
</ul></div>
<div class="section level3">
<h3 id="miscellaneous-1-39-0">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-1-39-0"></a></h3>
<ul><li>Improved how cgroups v1 and v2 settings are queried.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-39-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-39-0"></a></h3>
<ul><li>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> does a better job detecting cgroups v2 <code>cpu.max</code> CPU restrictions.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.38.0" id="version-1380">Version 1.38.0<a class="anchor" aria-label="anchor" href="#version-1380"></a></h2><p class="text-muted">CRAN release: 2024-07-27</p>
<div class="section level3">
<h3 id="new-features-1-38-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-38-0"></a></h3>
<ul><li><p>Now argument <code>rshcmd</code> of <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> can be a function. It must accept at least two arguments named <code>rshopts</code> and <code>worker</code>. The <code>rshopts</code> argument is a character vector of length zero or more. The <code>worker</code> argument is a string hostname. The function must return a single string.</p></li>
<li><p>Now <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> accepts <code>rscript_sh = "none"</code>, which skips quoting the Rscript call.</p></li>
<li><p>Now <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> accepts <code>rscript_sh</code> of length one or two. If <code>length(rscript_sh) == 2</code>, then <code>rscript_sh[1]</code> is for the inner and <code>rscript_sh[2]</code> is for the outer shell quoting of the Rscript call. More precisely, <code>rscript_sh[1]</code> is for Rscript arguments that need shell quoting (e.g. <code>Rscript -e "&lt;expr&gt;"</code>), and <code>rscript_sh[2]</code> is for the whole <code>Rscript ...</code> call.</p></li>
<li><p>Add <code><a href="../reference/makeClusterSequential.html">makeClusterSequential()</a></code> available for R (&gt;= 4.4.0).</p></li>
<li><p>Starting with R 4.5.0 (currently R-devel), one can use <code>parallel::makeCluster(n, type = parallelly::PSOCK)</code> as an alternative to <code>parallelly::makeClusterPSOCK(n)</code>. Similarly, <code>type    = parallelly::MPI</code> creates a cluster using <code><a href="../reference/makeClusterMPI.html">parallelly::makeClusterMPI()</a></code>, and <code>type = parallelly::SEQ</code> creates a cluster using <code><a href="../reference/makeClusterSequential.html">parallelly::makeClusterSequential()</a></code>.</p></li>
<li><p>Add <code><a href="../reference/serializedSize.html">serializedSize()</a></code> for calculating the size of an object by counting the number of bytes required to serialize it.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-38-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-38-0"></a></h3>
<ul><li>Environment variable <code>R_PARALLELLY_MAXWORKERS_LOCALHOST</code> was interpreted as integers rather than doubles.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.37.1" id="version-1371">Version 1.37.1<a class="anchor" aria-label="anchor" href="#version-1371"></a></h2><p class="text-muted">CRAN release: 2024-02-29</p>
<div class="section level3">
<h3 id="bug-fixes-1-37-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-37-1"></a></h3>
<ul><li>Version 1.37.0 would not install on FreeBSD.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.37.0" id="version-1370">Version 1.37.0<a class="anchor" aria-label="anchor" href="#version-1370"></a></h2><p class="text-muted">CRAN release: 2024-02-14</p>
<div class="section level3">
<h3 id="new-features-1-37-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-37-0"></a></h3>
<ul><li>
<code>makeClusterPSOCK(nworkers)</code> gained protection against setting up too many localhost workers relative to number of available CPU cores. If <code>nworkers / availableCores()</code> is greater than 1.0 (100%), then a warning is produced. If greater than 3.0 (300%), an error is produced. These limits can be configured by R option <code>parallelly.maxWorkers.localhost</code>. These checks are skipped if <code>nworkers</code> inherits from <code>AsIs</code>, e.g. <code>makeClusterPSOCK(I(16))</code>. The current 3.0 (300%) limit is likely to be decreased in a future release. A few packages fail <code>R CMD check --as-cran</code> with this validation enabled. For example, one package uses 8 parallel workers in its examples, while <code>R CMD check --as-cran</code> only allows for two. To give such packages time to be fixed, the CRAN-enforced limits are ignored for now.</li>
</ul></div>
<div class="section level3">
<h3 id="miscellaneous-1-37-0">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-1-37-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> could produce a confusing error <code>Invalid port:    NA</code> if a non-available port was requested. Now the error message is more informative, e.g. <code>Argument 'port' specifies non-available port(s): 80</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-37-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-37-0"></a></h3>
<ul><li>The internal method for checking if a TCP port is available has been improved. Previously, it could incorrectly conclude a port was available, when it was not.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.36.0" id="version-1360">Version 1.36.0<a class="anchor" aria-label="anchor" href="#version-1360"></a></h2><p class="text-muted">CRAN release: 2023-05-26</p>
<div class="section level3">
<h3 id="new-features-1-36-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-36-0"></a></h3>
<ul><li><p><code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> and <code><a href="../reference/killNode.html">killNode()</a></code> now support also worker processes that run on remote machines. They do this by connecting to the remote machine using the same method used to launch the worker, which is typically SSH, and do their R calls that way.</p></li>
<li><p><code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> and <code><a href="../reference/killNode.html">killNode()</a></code> gained argument <code>timeout</code> for controlling the maximum time, in seconds, before giving up and returning NA.</p></li>
<li><p>Add <code><a href="../reference/cloneNode.html">cloneNode()</a></code>, which can be used to “restart” <code>RichSOCKnode</code> cluster nodes.</p></li>
<li><p>Argument <code>worker</code> for <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> now takes the optional, logical attribute <code>localhost</code> to manually specify that the worker is a localhost worker.</p></li>
<li><p>Add <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> for <code>RichSOCKnode</code>, which gives more details than <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> for <code>SOCKnode</code>.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> for <code>RichSOCKnode</code> and <code>RichSOCKcluster</code> report on nodes with broken connections.</p></li>
<li><p>Add <code><a href="../reference/as.cluster.html">as.cluster()</a></code> for <code>RichSOCKnode</code>, which returns a <code>RichSOCKcluster</code>.</p></li>
<li><p>Introduce R option <code>parallelly.supportsMulticore.disableOn</code> to control where multicore processing is disabled by default.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-36-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-36-0"></a></h3>
<ul><li><p>Calling <code><a href="../reference/killNode.html">killNode()</a></code> on <code>RichSOCKnode</code> node could theoretically kill a process on the current machine with the same process ID (PID), although the parallel worker (node) is running on another machine.</p></li>
<li><p><code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> on <code>RichSOCKnode</code> node could theoretically return TRUE because there was a process with the same process ID (PID) on the current machine, although the parallel worker (node) is running on another machine.</p></li>
<li><p><code>isLocalHost()</code> for <code>SOCK0node</code> was not declared an S3 method.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.35.0" id="version-1350">Version 1.35.0<a class="anchor" aria-label="anchor" href="#version-1350"></a></h2><p class="text-muted">CRAN release: 2023-03-22</p>
<div class="section level3">
<h3 id="new-features-1-35-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-35-0"></a></h3>
<ul><li>Now <code><a href="../reference/freePort.html">freePort()</a></code> defaults to <code>default = NA_integer_</code>, so that <code>NA_integer_</code> is returned when no free port could be found. However, in R (&lt; 4.0.0), which does not support port querying, we use <code>default = "random"</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-35-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-35-0"></a></h3>
<ul><li>Mention in <code><a href="../reference/makeClusterPSOCK.html">help("makeClusterPSOCK")</a></code> that <code>rscript_sh = "cmd"</code> is needed if the remote machines run MS Windows.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-35-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-35-0"></a></h3>
<ul><li><p><code>makeClusterPSOCK(..., verbose = TRUE)</code> would not show verbose output. One still had to set option <code>parallelly.debug</code> to TRUE.</p></li>
<li><p><code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> could produce false sanity-check warnings on mismatching ‘PE_HOSTFILE’ content and ‘NSLOTS’ for certain SGE-cluster configurations.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.34.0" id="version-1340">Version 1.34.0<a class="anchor" aria-label="anchor" href="#version-1340"></a></h2><p class="text-muted">CRAN release: 2023-01-13</p>
<div class="section level3">
<h3 id="new-features-1-34-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-34-0"></a></h3>
<ul><li>Add support for <code>availableWorkers(constraints = "connections")</code>, which limits the number of workers that can be be used to the current number of free R connections according to <code><a href="../reference/availableConnections.html">freeConnections()</a></code>. This is the maximum number of PSOCK, SOCK, and MPI <strong>parallel</strong> cluster nodes we can open without running out of available R connections.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-34-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-34-0"></a></h3>
<ul><li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> would produce a warning <code>In is.na(constraints) :    is.na() applied to non-(list or vector) of type 'NULL'</code> when running with R (&lt; 4.0.0).</p></li>
<li><p><code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> did not acknowledge the <code>"cgroups2.cpu.max"</code> and <code>"Bioconductor"</code> methods added to <code><a href="../reference/availableCores.html">availableCores()</a></code> in <strong>parallelly</strong> 1.33.0 (2022-12-13). It also did not acknowledge methods <code>"cgroups.cpuset"</code> and <code>"cgroups.cpuquota"</code> added in <strong>parallelly</strong> 1.31.0 (2022-04-07), and <code>"nproc"</code> added in <strong>parallelly</strong> 1.26.1 (2021-06-29).</p></li>
<li><p>When <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> failed to connect to all parallel workers within the <code>connectTimeout</code> time limit, could either produce <code>Error    in sprintf(ngettext(failed, "Cluster setup failed    (connectTimeout=%.1f seconds). %d worker of %d failed to    connect.", : invalid format '%d'; use format %f, %e, %g or %a for    numeric objects</code> instead of an informative error message, or an error message with the incorrect information.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.33.0" id="version-1330">Version 1.33.0<a class="anchor" aria-label="anchor" href="#version-1330"></a></h2><p class="text-muted">CRAN release: 2022-12-14</p>
<div class="section level3">
<h3 id="new-features-1-33-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-33-0"></a></h3>
<ul><li><p>Add <code><a href="../reference/killNode.html">killNode()</a></code> to terminate cluster nodes via process signaling. Currently, this is only supported for parallel workers on the local machine, and only those created by <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> and likes now assert the running R session has enough permissions on the operating system to do system calls such as <code>system2("Rscript --version")</code>. If not, an informative error message is produced.</p></li>
<li><p>On Unix, <code><a href="../reference/availableCores.html">availableCores()</a></code> queries also control groups v2 (cgroups v2) field <code>cpu.max</code> for a possible CPU quota allocation. If a CPU quota is set, then the number of CPUs is rounded to the nearest integer, unless its less that 0.5, in case it’s rounded up to a single CPU. An example, where cgroups CPU quotas can be set to limit the total CPU load, is with Linux containers, e.g. <code>docker    run --cpus=3.5 ...</code>.</p></li>
<li><p>Add support for <code>availableCores(methods = "connections")</code>, which returns the current number of free R connections per <code><a href="../reference/availableConnections.html">freeConnections()</a></code>. This is the maximum number of PSOCK, SOCK, and MPI <strong>parallel</strong> cluster nodes we can open without running out of available R connections. A convenient way to use this and all other methods is <code>availableCores(constraints = "connections")</code>.</p></li>
<li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> recognizes environment variable <code>IS_BIOC_BUILD_MACHINE</code>, which is set to true by the Bioconductor (&gt;= 3.16) check servers. If true, then a maximum of four (4) cores is returned. This new environment variable replaces legacy variable <code>BBS_HOME</code> used in Bioconductor (&lt;= 3.15).</p></li>
<li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> splits up method <code>"BiocParallel"</code> into two; <code>"BiocParallel"</code> and <code>"Bioconductor"</code>. The former queries environment variable <code>BIOCPARALLEL_WORKER_NUMBER</code> and the latter <code>IS_BIOC_BUILD_MACHINE</code>. This means <code>availableCores(which =    "all")</code> now reports on both.</p></li>
<li><p><code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> will now produce a once-per-session informative warning when it detects that it is not possible to check whether another process is alive on the current machine.</p></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-33-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-33-0"></a></h3>
<ul><li><p>Add section to <code><a href="../reference/makeClusterPSOCK.html">help("makeClusterPSOCK", package = "parallelly")</a></code> explaining why <code>R CMD check</code> may produce “checking for detritus in the temp directory … NOTE” and how to avoid them.</p></li>
<li><p>Add section ‘For package developers’ to <code><a href="../reference/makeClusterPSOCK.html">help("makeClusterPSOCK",    package = "parallelly")</a></code> reminding us that we need to stop all clusters we created in package examples, tests, and vignettes.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-33-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-33-0"></a></h3>
<ul><li>
<code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> failed to record which method works for testing if a process exists or not, which meant it would keep trying all methods each time. Similarly, if none works, it would still keep trying each time instead of returning NA immediately. On some systems, failing to check whether a process exists could result in one or more warnings, in which case those warnings would be produced for each call to <code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.32.1" id="version-1321">Version 1.32.1<a class="anchor" aria-label="anchor" href="#version-1321"></a></h2><p class="text-muted">CRAN release: 2022-07-21</p>
<div class="section level3">
<h3 id="bug-fixes-1-32-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-32-1"></a></h3>
<ul><li>The <code>host</code> element of the <code>SOCK0node</code> or <code>SOCKnode</code> objects created by <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> lost attribute <code>localhost</code> for localhost workers. This made some error messages from the <strong>future</strong> package less informative.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.32.0" id="version-1320">Version 1.32.0<a class="anchor" aria-label="anchor" href="#version-1320"></a></h2><p class="text-muted">CRAN release: 2022-06-07</p>
<div class="section level3">
<h3 id="significant-changes-1-32-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-32-0"></a></h3>
<ul><li>The default for argument <code>revtunnel</code> of <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, and therefore also of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, is now <code>NA</code>, which means it’s agile to whether <code>rshcmd[1]</code> specifies an SSH client, or not. If SSH is used, then it will resolve to <code>revtunnel = TRUE</code>, otherwise to <code>revtunnel = FALSE</code>. This removed the need for setting <code>revtunnel = FALSE</code>, when non-SSH clients are used.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-32-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-32-0"></a></h3>
<ul><li>
<code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> gained support for the ‘Fujitsu Technical Computing Suite’ job scheduler. Specifically, they acknowledges environment variables <code>PJM_VNODE_CORE</code>, <code>PJM_PROC_BY_NODE</code>, and <code>PJM_O_NODEINF</code>. See <code><a href="../reference/makeClusterPSOCK.html">help("makeClusterPSOCK", package = "parallelly")</a></code> for an example.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-32-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-32-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> would fail with <code>Error:    node$session_info$process$pid == pid is not TRUE</code> when running R in Simplified Chinese (<code>LANGUAGE=zh_CN</code>), Traditional Chinese (Taiwan) (<code>LANGUAGE=zh_TW</code>), or Korean (<code>LANGUAGE=ko</code>) locales.</p></li>
<li><p>Some warnings and errors showed the wrong call.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.31.1" id="version-1311">Version 1.31.1<a class="anchor" aria-label="anchor" href="#version-1311"></a></h2><p class="text-muted">CRAN release: 2022-04-22</p>
<div class="section level3">
<h3 id="bug-fixes-1-31-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-31-1"></a></h3>
<ul><li><p>Changes to option <code>parallelly.availableCores.system</code> would be ignored if done after the first call to <code><a href="../reference/availableCores.html">availableCores()</a></code>.</p></li>
<li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> with option <code>parallelly.availableCores.system</code> set to less that <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code> would produce a warning, e.g. “[INTERNAL]: Will ignore the cgroups CPU set, because it contains one or more CPU indices that is out of range [0,0]: 0-7”.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.31.0" id="version-1310">Version 1.31.0<a class="anchor" aria-label="anchor" href="#version-1310"></a></h2><p class="text-muted">CRAN release: 2022-04-07</p>
<div class="section level3">
<h3 id="significant-changes-1-31-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-31-0"></a></h3>
<ul><li>Changed the default for argument default of <code><a href="../reference/freePort.html">freePort()</a></code> to <code>"random"</code>, which used to be <code>"first"</code>. The main reason for this is to make sure the default behavior is to return a random port also on R (&lt; 4.0.0) where we cannot test whether or not a port is available.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-31-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-31-0"></a></h3>
<ul><li><p>On Unix, <code><a href="../reference/availableCores.html">availableCores()</a></code> now queries also control groups (cgroups) fields <code>cpu.cfs_quota_us</code> and <code>cpu.cfs_period_us</code>, for a possible CPU quota allocation. If a CPU quota is set, then the number of CPUs is rounded to the nearest integer, unless its less that 0.5, in case it’s rounded up to a single CPU. An example, where cgroups CPU quotas can be set to limit the total CPU load, is with Linux containers, e.g. <code>docker run --cpus=3.5 ...</code>.</p></li>
<li><p>In addition to cgroups CPU quotas, <code><a href="../reference/availableCores.html">availableCores()</a></code> also queries cgroups for a possible CPU affinity, which is available in field <code>cpuset.set</code>. This should give the same result as what the already existing ‘nproc’ method gives. However, not all systems have the <code>nproc</code> tool installed, in which case this new approach should work. Some high-performance compute (HPC) environments set the CPU affinity so that jobs do not overuse the CPUs. It may also be set by Linux containers, e.g. <code>docker run --cpuset-cpus=0-2,8 ...</code>.</p></li>
<li><p>The minimum value returned by <code><a href="../reference/availableCores.html">availableCores()</a></code> is one (1). This can be overridden by new option <code>parallelly.availableCores.min</code>. This can be used to test parallelization methods on single-core machines, e.g. <code>options(parallelly.availableCores.min = 2L)</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-31-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-31-0"></a></h3>
<ul><li><p>The ‘nproc’ result for <code><a href="../reference/availableCores.html">availableCores()</a></code> was ignored if nproc &gt; 9.</p></li>
<li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> would return the ‘fallback’ value when only ‘system’ and ‘nproc’ information was available. However, in this case, we do want it to return ‘nproc’ when ‘nproc’ != ‘system’, because that is a strong indication that the number of CPU cores is limited by control groups (cgroups) on Linux. If ‘nproc’ == ‘system’, we cannot tell whether cgroups is enabled or not, which means we will fall back to the ‘fallback’ value if there is no other evidence that another number of cores are available to the current R process.</p></li>
<li><p>Technically, <code>canPortBeUsed()</code> could falsely return FALSE if the port check was interrupted by, say, a user interrupt.</p></li>
<li><p><code>freePort(ports, default = "random")</code> would always use return <code>ports[1]</code> if the system does not allow testing if a port is available or not, or if none of the specified ports are available.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.30.0" id="version-1300">Version 1.30.0<a class="anchor" aria-label="anchor" href="#version-1300"></a></h2><p class="text-muted">CRAN release: 2021-12-17</p>
<div class="section level3">
<h3 id="new-features-1-30-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-30-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, and therefore also <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, gained argument <code>rscript_sh</code>, which controls how <code>Rscript</code> arguments are shell quoted. The default is to make a best guess on what type of shell is used where each cluster node is launched. If launched locally, then it whatever platform the current R session is running, i.e. either a POSIX shell (<code>"sh"</code>) or MS Windows (<code>"cmd"</code>). If remotely, then the assumption is that a POSIX shell (<code>"sh"</code>) is used.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, and therefore also <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, gained argument <code>default_packages</code>, which controls the default set of R packages to be attached on each cluster node at startup. Moreover, if argument <code>rscript</code> specifies an ‘Rscript’ executable, then argument <code>default_packages</code> is used to populate Rscript command-line option <code>--default-packages=...</code>. If <code>rscript</code> specifies something else, e.g. an ‘R’ or ‘Rterm’ executable, then environment variable <code>R_DEFAULT_PACKAGES=...</code> is set accordingly when launching each cluster node.</p></li>
<li><p>Argument <code>rscript_args</code> of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now supports <code>"*"</code> values. When used, the corresponding element will be replaced with the internally added Rscript command-line options. If not specified, such options are appended at the end.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-30-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-30-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> did not support backslashes (<code>\</code>) in <code>rscript_libs</code>, backslashes that may originate from, for example, Windows network drives. The result was that the worker would silently ignore any <code>rscript_libs</code> components with backslashes.</p></li>
<li><p>The package detects when <code>R CMD check</code> runs and adjust default settings via environment variables in order to play nicer with the machine where the checks are running. Some of these environment variables were in this case ignored since <strong>parallelly</strong> 1.26.0.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.29.0" id="version-1290">Version 1.29.0<a class="anchor" aria-label="anchor" href="#version-1290"></a></h2><p class="text-muted">CRAN release: 2021-11-21</p>
<div class="section level3">
<h3 id="significant-changes-1-29-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-29-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> launches parallel workers with option <code>socketOptions</code> set to <code>"no-delay"</code> by default. This decreases the communication latency between workers and the main R session, significantly so on Unix. This option requires R (&gt;= 4.1.0) and has no effect in early versions of R.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-29-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-29-0"></a></h3>
<ul><li><p>Added argument <code>socketOptions</code> to <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, which sets the corresponding R option on each cluster node when they are launched.</p></li>
<li><p>Argument <code>rscript_envs</code> of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> can also be used to unset environment variables cluster nodes. Any named element with value <code>NA_character_</code> will be unset.</p></li>
<li><p>Argument <code>rscript</code> of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now supports <code>"*"</code> values. When used, the corresponding element will be replaced with the <code>"Rscript"</code>, or if <code>homogenous = TRUE</code>, then absolute path to current ‘Rscript’.</p></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-29-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-29-0"></a></h3>
<ul><li>Add <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> example on how to launch workers distributed across multiple CPU Groups on MS Windows 10.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-29-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-29-0"></a></h3>
<ul><li><p><code><a href="../reference/isForkedChild.html">isForkedChild()</a></code> would only return TRUE in a forked child process, if and only if, it had already been called in the parent R process.</p></li>
<li><p>Using argument <code>rscript_startup</code> would cause <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> to fail in R-devel (&gt;= r80666).</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.28.1" id="version-1281">Version 1.28.1<a class="anchor" aria-label="anchor" href="#version-1281"></a></h2><p class="text-muted">CRAN release: 2021-09-09</p>
<div class="section level3">
<h3 id="cran-policies-1-28-1">CRAN Policies<a class="anchor" aria-label="anchor" href="#cran-policies-1-28-1"></a></h3>
<ul><li>
<code>example("isNodeAlive")</code> now uses <code>\donttest{}</code> to avoid long (&gt; 10
<ol start="19" style="list-style-type: lower-alpha"><li>elapsed run times on MS Windows.</li>
</ol></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.28.0" id="version-1280">Version 1.28.0<a class="anchor" aria-label="anchor" href="#version-1280"></a></h2>
<div class="section level3">
<h3 id="new-features-1-28-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-28-0"></a></h3>
<ul><li><p>Add <code><a href="../reference/isNodeAlive.html">isNodeAlive()</a></code> to check whether a cluster and cluster nodes are alive or not.</p></li>
<li><p>Add <code><a href="../reference/isForkedChild.html">isForkedChild()</a></code> to check whether or not the current R process is a forked child process.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-28-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-28-0"></a></h3>
<ul><li><p>Environment variable <code>R_PARALLELLY_SUPPORTSMULTICORE_UNSTABLE</code> was incorrectly parsed as a logical instead of a character string. If the variables was set to, say, <code>"quiet"</code>, this would cause an error when the package was loaded.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> failed to fall back to <code>setup_strategy =    "sequential"</code>, when not supported by the current R version.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.27.0" id="version-1270">Version 1.27.0<a class="anchor" aria-label="anchor" href="#version-1270"></a></h2><p class="text-muted">CRAN release: 2021-07-19</p>
<div class="section level3">
<h3 id="new-features-1-27-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-27-0"></a></h3>
<ul><li>
<code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> now respects environment variable <code>BIOCPARALLEL_WORKER_NUMBER</code> introduced in <strong>BiocParallel</strong> (&gt;= 1.27.2). They also respect <code>BBS_HOME</code> which is set on the Bioconductor check servers to limit the number of parallel workers while checking Bioconductor packages.</li>
</ul></div>
<div class="section level3">
<h3 id="workaround-1-27-0">Workaround<a class="anchor" aria-label="anchor" href="#workaround-1-27-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> and <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code> failed with error “Cluster setup failed. <n> of <n> workers failed to connect.” when using the new default <code>setup_strategy = "parallel"</code> and when the <strong>tcltk</strong> package is loaded when running R (&gt;= 4.0.0 &amp;&amp; &lt;= 4.1.0) on macOS. Now <strong>parallelly</strong> forces <code>setup_strategy =    "sequential"</code> when the <strong>tcltk</strong> package is loaded on these R versions.</n></n></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-27-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-27-0"></a></h3>
<ul><li><p><code>makeClusterPSOCK(..., setup_strategy = "parallel")</code> would forget to close an socket connection used to set up the workers. This socket connection would be closed by the garbage collector eventually with a warning.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">parallelly::makeClusterPSOCK()</a></code> would fail with “Error in freePort(port) : Unknown value on argument ‘port’: ‘auto’” if environment variable <code>R_PARALLEL_PORT</code> was set to a port number.</p></li>
<li><p><code><a href="../reference/availableCores.html">parallelly::availableCores()</a></code> would produce ‘Error in if (grepl(“^ [1-9]$”, res)) return(as.integer(res)) : argument is of length zero’ on Linux systems without <code>nproc</code> installed.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.26.1" id="version-1261">Version 1.26.1<a class="anchor" aria-label="anchor" href="#version-1261"></a></h2><p class="text-muted">CRAN release: 2021-06-30</p>
<div class="section level3">
<h3 id="new-features-1-26-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-26-1"></a></h3>
<ul><li>
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> on <code>RichSOCKcluster</code> mentions when the cluster is registered to be automatically stopped by the garbage collector.</li>
</ul></div>
<div class="section level3">
<h3 id="workaround-1-26-1">Workaround<a class="anchor" aria-label="anchor" href="#workaround-1-26-1"></a></h3>
<ul><li>Depending on R version used, the RStudio Console does not support the new <code>setup_strategy = "parallel"</code> when using <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> or <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code>. The symptom is that they, after a long wait, result in “Error in makeClusterPSOCK(workers, …) : Cluster setup failed. <n> of <n> workers failed to connect.” This is due to a bug in R, which has been fixed for R (&gt;= 4.1.1) but also in a recent R 4.1.0 Patched. For R (&gt;= 4.0.0) or R (&lt;= 4.1.0), this release works around the problem by forcing <code>setup_strategy = "sequential</code> for <strong>parallelly</strong> and <strong>parallel</strong> when running in the RStudio Console. If you wish to override this behavior, you can always set option <code>parallelly.makeNodePSOCK.setup_strategy</code> to <code>"parallel"</code>, e.g. in your <code>~/.Rprofile</code> file. Alternatively, you can set the environment variable <code>R_PARALLELLY_MAKENODEPSOCK_SETUP_STRATEGY=parallel</code>, e.g. in your <code>~/.Renviron</code> file.</n></n></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-26-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-26-1"></a></h3>
<ul><li>On systems with <code>nproc</code> installed, <code><a href="../reference/availableCores.html">availableCores()</a></code> would be limited by environment variables <code>OMP_NUM_THREADS</code> and <code>OMP_THREAD_LIMIT</code>, if set. For example, on conservative systems that set <code>OMP_NUM_THREADS=1</code> as the default, <code><a href="../reference/availableCores.html">availableCores()</a></code> would pick this up via <code>nproc</code> and return 1. This was not the intended behavior. Now those environment variables are temporarily unset before querying <code>nproc</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.26.0" id="version-1260">Version 1.26.0<a class="anchor" aria-label="anchor" href="#version-1260"></a></h2><p class="text-muted">CRAN release: 2021-06-09</p>
<div class="section level3">
<h3 id="significant-changes-1-26-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-26-0"></a></h3>
<ul><li>
<code>R_PARALLELLY_*</code> (and <code>R_FUTURE_*</code>) environment variables are now only read when the <strong>parallelly</strong> package is loaded, where they set the corresponding <code>parallelly.*</code> option. Previously, some of these environment variables were queried by different functions as a fallback to when an option was not set. By only parsing them when the package is loaded, it decrease the overhead in functions, and it clarifies that options can be changed at runtime whereas environment variables should only be set at startup.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-26-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-26-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now support setting up cluster nodes in parallel similarly to how <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makePSOCKcluster()</a></code> does it. This significantly reduces the setup turnaround time. This is only supported in R (&gt;= 4.0.0). To revert to the sequential setup strategy, set R option <code>parallelly.makeNodePSOCK.setup_strategy</code> to <code>"sequential"</code>.</p></li>
<li><p>Add <code><a href="../reference/freePort.html">freePort()</a></code> to get a random TCP port that can be opened.</p></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-26-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-26-0"></a></h3>
<ul><li>Documenting more R options and environment variables used by this package.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-26-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-26-0"></a></h3>
<ul><li>R option <code>parallelly.availableCores.fallback</code> and environment variable <code>R_PARALLELLY_AVAILABLECORES_FALLBACK</code> was ignored since <strong>parallelly</strong> 1.22.0, when support for ‘nproc’ was added to <code><a href="../reference/availableCores.html">availableCores()</a></code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.25.0" id="version-1250">Version 1.25.0<a class="anchor" aria-label="anchor" href="#version-1250"></a></h2><p class="text-muted">CRAN release: 2021-04-30</p>
<div class="section level3">
<h3 id="significant-changes-1-25-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-25-0"></a></h3>
<ul><li>The default SSH client on MS Windows 10 is now the built in <code>ssh</code> client. This means that regardless whether you are on Linux, macOS, or Windows 10, setting up parallel workers on external machines over SSH finally works out of the box without having to install PuTTY or other SSH clients. This was possible because a workaround was found for a Windows 10 bug preventing us from using reverse tunneling over SSH. It turns out the bug reveals itself when using hostname ‘localhost’ but not ‘127.0.0.1’, so we use the latter.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-25-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-25-0"></a></h3>
<ul><li>
<code><a href="../reference/availableCores.html">availableCores()</a></code> gained argument <code>omit</code> to make it easier to put aside zero or more cores from being used in parallel processing. For example, on a system with four cores, <code>availableCores(omit =    1)</code> returns 3. Importantly, since <code><a href="../reference/availableCores.html">availableCores()</a></code> is guaranteed to always return a positive integer, <code>availableCores(omit = 4) ==    1</code>, even on systems with four or fewer cores. Using <code>availableCores() - 4</code> on such systems would return a non-positive value, which would give an error downstream.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-25-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-25-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, or actually <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, did not accept all types of environment variable names when using <code>rscript_envs</code>, e.g. it would give an error if we tried to pass <code>_R_CLASS_MATRIX_ARRAY_</code>.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> had a “length &gt; 1 in coercion to logical” bug that could affect especially MS Windows 10 users.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.24.0" id="version-1240">Version 1.24.0<a class="anchor" aria-label="anchor" href="#version-1240"></a></h2><p class="text-muted">CRAN release: 2021-03-14</p>
<div class="section level3">
<h3 id="significant-changes-1-24-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-24-0"></a></h3>
<ul><li>The default SSH client on MS Windows is now, in order of availability: (i) <code>plink</code> of the PuTTY software, (ii) <code>ssh</code> in the RStudio distribution, and (iii) <code>ssh</code> of Windows 10. Previously, the latter was considered first but that still has a bug preventing us from using reverse tunneling.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-24-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-24-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, or actually <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, gained argument <code>quiet</code>, which can be used to silence output produced by <code>manual = TRUE</code>.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> for <code>cluster</code> objects now warns about duplicated cluster nodes.</p></li>
<li><p>Add <code><a href="../reference/isForkedNode.html">isForkedNode()</a></code> to test if a cluster node runs in a forked process.</p></li>
<li><p>Add <code><a href="../reference/isLocalhostNode.html">isLocalhostNode()</a></code> to test if a cluster node runs on the current machine.</p></li>
<li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> avoid recursive calls to the custom function given by options <code>parallelly.availableCores.custom</code> and <code>parallelly.availableWorkers.custom</code>, respectively.</p></li>
<li><p><code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> now recognizes the Slurm environment variable <code>SLURM_JOB_NODELIST</code>, e.g. <code>"dev1,n[3-4,095-120]"</code>. It will use <code>scontrol show hostnames "$SLURM_JOB_NODELIST"</code> to expand it, if supported on the current machine, otherwise it will attempt to parse and expand the nodelist specification using R. If either of environment variable <code>SLURM_JOB_CPUS_PER_NODE</code> or <code>SLURM_TASKS_PER_NODE</code> is set, then each node in the nodelist will be represented that number of times. If in addition, environment variable <code>SLURM_CPUS_PER_TASK</code> (always a scalar), then that is also respected.</p></li>
</ul></div>
<div class="section level3">
<h3 id="miscellaneous-1-24-0">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-1-24-0"></a></h3>
<ul><li>All code is now using the <code>parallelly.</code> prefix for options and the <code>R_PARALLELLY_</code> prefix for environment variables. Settings that use the corresponding <code>future.</code> and <code>R_FUTURE_</code> prefixes are still recognized.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-24-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-24-0"></a></h3>
<ul><li><p><code><a href="../reference/availableCores.html">availableCores()</a></code> did not respect environment variable <code>SLURM_TASKS_PER_NODE</code> when the job was allocated more than one node.</p></li>
<li><p>Above argument <code>quiet</code> was introduced in <strong>future</strong> 1.19.1 but was mistakenly dropped from <strong>parallelly</strong> 1.20.0 when that was released, and therefore also from <strong>future</strong> (&gt;= 1.20.0).</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.23.0" id="version-1230">Version 1.23.0<a class="anchor" aria-label="anchor" href="#version-1230"></a></h2><p class="text-muted">CRAN release: 2021-01-04</p>
<div class="section level3">
<h3 id="new-features-1-23-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-23-0"></a></h3>
<ul><li><p><code><a href="../reference/availableCores.html">availableCores()</a></code>, <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code>, and <code><a href="../reference/freeCores.html">freeCores()</a></code> gained argument <code>logical</code>, which is passed down to <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code> as-is. The default is TRUE but it can be changed by setting the R option <code>parallelly.availableCores.logical</code>. This option can in turn be set via environment variable <code>R_PARALLELLY_AVAILABLECORES_LOGICAL</code> which is applied (only) when the package is loaded.</p></li>
<li><p>Now <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> asserts that there are enough free connections available before attempting to create the parallel workers. If too many workers are requested, an informative error message is produced.</p></li>
<li><p>Add <code><a href="../reference/availableConnections.html">availableConnections()</a></code> and <code><a href="../reference/availableConnections.html">freeConnections()</a></code> to infer the maximum number of connections that the current R installation can have open at any time and how many of those are currently free to be used. This limit is typically 128 but may be different in custom R installations that are built from source.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.22.0" id="version-1220">Version 1.22.0<a class="anchor" aria-label="anchor" href="#version-1220"></a></h2><p class="text-muted">CRAN release: 2020-12-13</p>
<div class="section level3">
<h3 id="new-features-1-22-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-22-0"></a></h3>
<ul><li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> queries also Unix command <code>nproc</code>, if available. This will make it respect the number of CPU/cores limited by ‘cgroups’ and Linux containers.</p></li>
<li><p>PSOCK cluster workers are now set up to communicate using little endian (<code>useXDR = FALSE</code>) instead of big endian (<code>useXDR = TRUE</code>). Since most modern systems use little endian, <code>useXDR = FALSE</code> speeds up the communication noticeably (10-15%) on those systems. The default value of this argument can be controlled by the R option <code>parallelly.makeNodePSOCK.useXDR</code> or the corresponding environment variable <code>R_PARALLELLY_MAKENODEPSOCK_USEXDR</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="beta-features-1-22-0">Beta Features<a class="anchor" aria-label="anchor" href="#beta-features-1-22-0"></a></h3>
<ul><li><p>Add <code><a href="../reference/cpuLoad.html">cpuLoad()</a></code> for querying the “average” system load on Unix-like systems.</p></li>
<li><p>Add <code><a href="../reference/freeCores.html">freeCores()</a></code> for estimating the average number of unused cores based on the average system load as given by <code><a href="../reference/cpuLoad.html">cpuLoad()</a></code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-22-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-22-0"></a></h3>
<ul><li>Except for environment variables <code>R_FUTURE_AVAILABLECORES_FALLBACK</code> and <code>R_FUTURE_AVAILABLECORES_SYSTEM</code>, none of the <code>R_PARALLELLY_*</code> and <code>R_FUTURE_*</code> ones where recognized.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.21.0" id="version-1210">Version 1.21.0<a class="anchor" aria-label="anchor" href="#version-1210"></a></h2><p class="text-muted">CRAN release: 2020-10-27</p>
<div class="section level3">
<h3 id="significant-changes-1-21-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-21-0"></a></h3>
<ul><li>Removed <code><a href="../reference/find_rshcmd.html">find_rshcmd()</a></code> which was never meant to be exported.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-21-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-21-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained argument <code>validate</code> to control whether or not the nodes should be tested after they’ve been created. The validation is done by querying each node for its session information, which is then saved as attribute <code>session_info</code> on the cluster node object. This information is also used in error messages, if available. This validation has been done since version 1.5.0 but now it can be disabled. The default of argument <code>validate</code> can be controlled via an R options and an environment variable.</p></li>
<li><p>Now <code>makeNodePSOCK(..., rscript_envs = "UNKNOWN")</code> produces an informative warning on non-existing environment variables that was skipped.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-21-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-21-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> would produce an error on ‘one node produced an error: could not find function “getOptionOrEnvVar”’ if <strong>parallelly</strong> is not available on the node.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> would attempt to load <strong>parallelly</strong> on the worker. If it’s not available on the worker, it would result in a silent warning on the worker. Now <strong>parallelly</strong> is not loaded.</p></li>
<li><p><code>makeClusterPSOCK(..., tries = n)</code> would retry to setup a cluster node also on errors that were unrelated to node setup or node connection errors.</p></li>
<li><p>The error message on using an invalid <code>rscript_envs</code> argument for <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> reported on the value of <code>rscript_libs</code> (sic!).</p></li>
<li><p><code>makeNodePSOCK(..., rscript_envs = "UNKNOWN")</code> would result in an error when trying to launch the cluster node.</p></li>
</ul></div>
<div class="section level3">
<h3 id="deprecated-and-defunct-1-21-0">Deprecated and Defunct<a class="anchor" aria-label="anchor" href="#deprecated-and-defunct-1-21-0"></a></h3>
<ul><li>Removed <code><a href="../reference/find_rshcmd.html">find_rshcmd()</a></code> which was never meant to be exported.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.20.0" id="version-1200">Version 1.20.0<a class="anchor" aria-label="anchor" href="#version-1200"></a></h2><p class="text-muted">CRAN release: 2020-10-20</p>
<div class="section level3">
<h3 id="significant-changes-1-20-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-20-0"></a></h3>
<ul><li>Add <code><a href="../reference/availableCores.html">availableCores()</a></code>, and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code>, <code><a href="../reference/supportsMulticore.html">supportsMulticore()</a></code>, <code><a href="../reference/as.cluster.html">as.cluster()</a></code>, <code><a href="../reference/autoStopCluster.html">autoStopCluster()</a></code>, <code><a href="../reference/makeClusterMPI.html">makeClusterMPI()</a></code>, <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, and <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> from the <strong>future</strong> package.</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-20-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-20-0"></a></h3>
<ul><li>Add <code><a href="../reference/isConnectionValid.html">isConnectionValid()</a></code> and <code><a href="../reference/isConnectionValid.html">connectionId()</a></code> adopted from internal code of the <strong>future</strong> package.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-20-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-20-0"></a></h3>
<ul><li><p>Renamed environment variable <code>R_FUTURE_MAKENODEPSOCK_tries</code> used by <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> to <code>R_FUTURE_MAKENODEPSOCK_TRIES</code>.</p></li>
<li><p><code><a href="../reference/isConnectionValid.html">connectionId()</a></code> did not return <code>-1L</code> on Solaris for connections with internal ‘nil’ pointers because they were reported as ‘0’ - not ‘nil’ or ‘0x0’.</p></li>
</ul></div>
<div class="section level3">
<h3 id="history-1-20-0">History<a class="anchor" aria-label="anchor" href="#history-1-20-0"></a></h3>
<ul><li>Below is an excerpt of the <strong>future</strong>’s NEWS entries that are related to the functions in this package.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.19.0" id="version-1190">Version 1.19.0<a class="anchor" aria-label="anchor" href="#version-1190"></a></h2>
<div class="section level3">
<h3 id="significant-changes-1-19-0">Significant Changes<a class="anchor" aria-label="anchor" href="#significant-changes-1-19-0"></a></h3>
<ul><li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> better supports Slurm. Specifically, if environment variable <code>SLURM_CPUS_PER_TASK</code> is not set, which requires that option <code>--slurm-cpus-per-task=n</code> is specified and <code>SLURM_JOB_NUM_NODES=1</code>, then it falls back to using <code>SLURM_CPUS_ON_NODE</code>, e.g. when using <code>--ntasks=n</code>.</p></li>
<li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> supports LSF/OpenLava. Specifically, they acknowledge environment variable <code>LSB_DJOB_NUMPROC</code> and <code>LSB_HOSTS</code>, respectively.</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-19-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-19-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> will now retry to create a cluster node up to <code>tries</code> (default: 3) times before giving up. If argument <code>port</code> species more than one port (e.g. <code>port = "random"</code>) then it will also attempt find a valid random port up to <code>tries</code> times before giving up. The pre-validation of the random port is only supported in R (&gt;= 4.0.0) and skipped otherwise.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> skips shell quoting of the elements in <code>rscript</code> if it inherits from <code>AsIs</code>.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, or actually <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, gained argument <code>quiet</code>, which can be used to silence output produced by <code>manual = TRUE</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="performance-1-19-0">Performance<a class="anchor" aria-label="anchor" href="#performance-1-19-0"></a></h3>
<ul><li>Now <code>plan(multisession)</code>, <code>plan(cluster, workers = &lt;number&gt;)</code>, and <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> which they both use internally, sets up localhost workers twice as fast compared to versions since <strong>future</strong> 1.12.0, which brings it back to par with a bare-bone <code>parallel::makeCluster(..., setup_strategy = "sequential")</code> setup. The slowdown was introduced in <strong>future</strong> 1.12.0 (2019-03-07) when protection against leaving stray R processes behind from failed worker startup was implemented. This protection now makes use of memoization for speedup.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.18.0" id="version-1180">Version 1.18.0<a class="anchor" aria-label="anchor" href="#version-1180"></a></h2>
<div class="section level3">
<h3 id="new-features-1-18-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-18-0"></a></h3>
<ul><li><p><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> on <code>RichSOCKcluster</code> gives information not only on the name of the host but also on the version of R and the platform of each node (“worker”), e.g. “Socket cluster with 3 nodes where 2 nodes are on host ‘localhost’ (R version 4.0.0 (2020-04-24), platform x86_64-w64-mingw32), 1 node is on host ‘n3’ (R version 3.6.3 (2020-02-29), platform x86_64-pc-linux-gnu)”.</p></li>
<li><p>It is now possible to set environment variables on workers before they are launched by <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> by specify them as as <code>&lt;name&gt;=&lt;value&gt;</code> as part of the <code>rscript</code> vector argument, e.g. <code>rscript=c("ABC=123", "DEF='hello world'", "Rscript")</code>. This works because elements in <code>rscript</code> that match regular expression <code>"^ [[:alpha:]_][[:alnum:]_]*=.*"</code> are no longer shell quoted.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now returns a cluster that in addition to inheriting from <code>SOCKcluster</code> it will also inherit from <code>RichSOCKcluster</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-18-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-18-0"></a></h3>
<ul><li><p>Made <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> and <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> agile to the name change from <code>parallel:::.slaveRSOCK()</code> to <code>parallel:::.workRSOCK()</code> in R (&gt;= 4.1.0).</p></li>
<li><p><code>makeClusterPSOCK(..., rscript)</code> will not try to locate <code>rscript[1]</code> if argument <code>homogeneous</code> is FALSE (or inferred to be FALSE).</p></li>
<li><p><code>makeClusterPSOCK(..., rscript_envs)</code> would result in a syntax error when starting the workers due to non-ASCII quotation marks if option <code>useFancyQuotes</code> was not set to FALSE.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.17.0" id="version-1170">Version 1.17.0<a class="anchor" aria-label="anchor" href="#version-1170"></a></h2>
<div class="section level3">
<h3 id="new-features-1-17-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-17-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained argument <code>rscript_envs</code> for setting environment variables in workers on startup, e.g. <code>rscript_envs =    c(FOO = "3.14", "BAR")</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="miscellaneous-1-17-0">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous-1-17-0"></a></h3>
<ul><li>Not all CRAN servers have <code>_R_CHECK_LIMIT_CORES_</code> set. To better emulate CRAN submission checks, the <strong>future</strong> package will, when loaded, set this environment variable to TRUE if unset and if <code>R    CMD check</code> is running. Note that <code><a href="https://parallelly.futureverse.org/reference/availableCores.html">future::availableCores()</a></code> respects <code>_R_CHECK_LIMIT_CORES_</code> and returns at most <code>2L</code> (two cores) if detected.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.15.1" id="version-1151">Version 1.15.1<a class="anchor" aria-label="anchor" href="#version-1151"></a></h2>
<div class="section level3">
<h3 id="new-features-1-15-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-15-1"></a></h3>
<ul><li>The default range of ports that <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> draws a random port from (when argument <code>port</code> is not specified) can now be controlled by environment variable <code>R_FUTURE_RANDOM_PORTS</code>. The default range is still <code>11000:11999</code> as with the <strong>parallel</strong> package.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.15.0" id="version-1150">Version 1.15.0<a class="anchor" aria-label="anchor" href="#version-1150"></a></h2>
<div class="section level3">
<h3 id="documentation-1-15-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-15-0"></a></h3>
<ul><li>Added ‘Troubleshooting’ section to <code><a href="../reference/makeClusterPSOCK.html">?makeClusterPSOCK</a></code> with instructions on how to troubleshoot when the setup of local and remote clusters fail.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-15-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-15-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> could produce warnings like “cannot open file ‘/tmp/alice/Rtmpi69yYF/future.parent=2622.a3e32bc6af7.pid’: No such file”, e.g. when launching R workers running in Docker containers.</p></li>
<li><p><code><a href="../reference/makeClusterMPI.html">makeClusterMPI()</a></code> did not work for MPI clusters with ‘comm’ other than ‘1’.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.13.0" id="version-1130">Version 1.13.0<a class="anchor" aria-label="anchor" href="#version-1130"></a></h2>
<div class="section level3">
<h3 id="new-features-1-13-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-13-0"></a></h3>
<ul><li><p>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> also recognizes PBS environment variable <code>NCPUS</code>, because the PBSPro scheduler does not set <code>PBS_NUM_PPN</code>.</p></li>
<li><p>If, option <code>future.availableCores.custom</code> is set to a function, then <code><a href="../reference/availableCores.html">availableCores()</a></code> will call that function and interpret its value as number of cores. Analogously, option <code>future.availableWorkers.custom</code> can be used to specify a hostnames of a set of workers that <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> sees. These new options provide a mechanism for anyone to customize <code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> in case they do not (yet) recognize, say, environment variables that are specific the user’s compute environment or HPC scheduler.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained support for argument <code>rscript_startup</code> for evaluating one or more R expressions in the background R worker prior to the worker event loop launching. This provides a more convenient approach than having to use, say, <code>rscript_args =    c("-e", sQuote(code))</code>.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained support for argument <code>rscript_libs</code> to control the R package library search path on the workers. For example, to <em>prepend</em> the folder <code>~/R-libs</code> on the workers, use <code>rscript_libs = c("~/R-libs", "*")</code>, where <code>"*"</code> will be resolved to the current <code><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths()</a></code> on the workers.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-13-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-13-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> did not shell quote the Rscript executable when running its pre-tests checking whether localhost Rscript processes can be killed by their PIDs or not.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.12.0" id="version-1120">Version 1.12.0<a class="anchor" aria-label="anchor" href="#version-1120"></a></h2>
<div class="section level3">
<h3 id="new-features-1-12-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-12-0"></a></h3>
<ul><li>If <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> fails to create one of many nodes, then it will attempt to stop any nodes that were successfully created. This lowers the risk for leaving R worker processes behind.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-12-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-12-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> in <strong>future</strong> (&gt;= 1.11.1) produced warnings when argument <code>rscript</code> had <code>length(rscript) &gt; 1</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.11.1.1" id="version-11111">Version 1.11.1.1<a class="anchor" aria-label="anchor" href="#version-11111"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-11-1-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-11-1-1"></a></h3>
<ul><li>When <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> fails to connect to a worker, it produces an error with detailed information on what could have happened. In rare cases, another error could be produced when generating the information on what the workers PID is.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.11.1" id="version-1111">Version 1.11.1<a class="anchor" aria-label="anchor" href="#version-1111"></a></h2>
<div class="section level3">
<h3 id="new-features-1-11-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-11-1"></a></h3>
<ul><li>The defaults of several arguments of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> and <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> can now be controlled via environment variables in addition to R options that was supported in the past. An advantage of using environment variables is that they will be inherited by child processes, also nested ones.</li>
</ul></div>
<div class="section level3">
<h3 id="software-quality-1-11-1">Software Quality<a class="anchor" aria-label="anchor" href="#software-quality-1-11-1"></a></h3>
<ul><li>TESTS: When the <strong>future</strong> package is loaded, it checks whether <code>R    CMD check</code> is running or not. If it is, then a few future-specific environment variables are adjusted such that the tests play nice with the testing environment. For instance, it sets the socket connection timeout for PSOCK cluster workers to 120 seconds (instead of the default 30 days!). This will lower the risk for more and more zombie worker processes cluttering up the test machine (e.g. CRAN servers) in case a worker process is left behind despite the main R processes is terminated. Note that these adjustments are applied automatically to the checks of any package that depends on, or imports, the <strong>future</strong> package.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-11-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-11-1"></a></h3>
<ul><li>Whenever <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> would fail to connect to a worker, for instance due to a port clash, then it would leave the R worker process running - also after the main R process terminated. When the worker is running on the same machine, <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> will now attempt to kill such stray R processes. Note that <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makePSOCKcluster()</a></code> still has this problem.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.11.0" id="version-1110">Version 1.11.0<a class="anchor" aria-label="anchor" href="#version-1110"></a></h2>
<div class="section level3">
<h3 id="new-features-1-11-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-11-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> produces more informative error messages whenever the setup of R workers fails. Also, its verbose messages are now prefixed with “[local output]” to help distinguish the output produced by the current R session from that produced by background workers.</p></li>
<li><p>It is now possible to specify what type of SSH clients <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> automatically searches for and in what order, e.g. <code>rshcmd = c("&lt;rstudio-ssh&gt;", "&lt;putty-plink&gt;")</code>.</p></li>
<li><p>Now <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> preserves the global RNG state (<code>.Random.seed</code>) also when it draws a random port number.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained argument <code>rshlogfile</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-11-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-11-0"></a></h3>
<ul><li>
<code>makeClusterPSOCK(..., rscript = "my_r")</code> would in some cases fail to find the intended <code>my_r</code> executable.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.10.0" id="version-1100">Version 1.10.0<a class="anchor" aria-label="anchor" href="#version-1100"></a></h2>
<div class="section level3">
<h3 id="new-features-1-10-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-10-0"></a></h3>
<ul><li><p>Add <code>makeClusterMPI(n)</code> for creating MPI-based clusters of a similar kind as <code>parallel::makeCluster(n, type = "MPI")</code> but that also attempts to workaround issues where <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::stopCluster()</a></code> causes R to stall.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> and <code><a href="../reference/makeClusterMPI.html">makeClusterMPI()</a></code> gained argument <code>autoStop</code> for controlling whether the cluster should be automatically stopped when garbage collected or not.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.9.0" id="version-190">Version 1.9.0<a class="anchor" aria-label="anchor" href="#version-190"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-9-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-9-0"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> produced a warning when environment variable <code>R_PARALLEL_PORT</code> was set to <code>random</code> (e.g. as on CRAN).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.8.1" id="version-181">Version 1.8.1<a class="anchor" aria-label="anchor" href="#version-181"></a></h2>
<div class="section level3">
<h3 id="new-features-1-8-1">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-8-1"></a></h3>
<ul><li>
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now produces a more informative warning if environment variable <code>R_PARALLEL_PORT</code> specifies a non-numeric port.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.7.0" id="version-170">Version 1.7.0<a class="anchor" aria-label="anchor" href="#version-170"></a></h2>
<div class="section level3">
<h3 id="new-features-1-7-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-7-0"></a></h3>
<ul><li>On Windows, <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, and therefore <code>plan(multisession)</code> and <code>plan(multiprocess)</code>, will use the SSH client distributed with RStudio as a fallback if neither <code>ssh</code> nor <code>plink</code> is available on the system <code>PATH</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-7-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-7-0"></a></h3>
<ul><li>
<code>makeClusterPSOCK(..., renice = 19)</code> would launch each PSOCK worker via <code>nice +19</code> resulting in the error “nice: ‘+19’: No such file or directory”. This bug was inherited from <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makePSOCKcluster()</a></code>. Now using <code>nice --adjustment=19</code> instead.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.5.0" id="version-150">Version 1.5.0<a class="anchor" aria-label="anchor" href="#version-150"></a></h2>
<div class="section level3">
<h3 id="new-features-1-5-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-5-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now defaults to use the Windows PuTTY software’s SSH client <code>plink -ssh</code>, if <code>ssh</code> is not found.</p></li>
<li><p>Argument <code>homogeneous</code> of <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code>, a helper function of <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, will default to FALSE also if the hostname is a fully qualified domain name (FQDN), that is, it “contains periods”. For instance, <code>c('node1', 'node2.server.org')</code> will use <code>homogeneous = TRUE</code> for the first worker and <code>homogeneous = FALSE</code> for the second.</p></li>
<li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> now asserts that each cluster node is functioning by retrieving and recording the node’s session information including the process ID of the corresponding R process.</p></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-1-5-0">Documentation<a class="anchor" aria-label="anchor" href="#documentation-1-5-0"></a></h3>
<ul><li>Help on <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> gained more detailed descriptions on arguments and what their defaults are.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.4.0" id="version-140">Version 1.4.0<a class="anchor" aria-label="anchor" href="#version-140"></a></h2>
<div class="section level3">
<h3 id="new-features-1-4-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-4-0"></a></h3>
<ul><li>The default values for arguments <code>connectTimeout</code> and <code>timeout</code> of <code><a href="../reference/makeClusterPSOCK.html">makeNodePSOCK()</a></code> can now be controlled via global options.</li>
</ul></div>
<div class="section level3">
<h3 id="deprecated-and-defunct-1-4-0">Deprecated and Defunct<a class="anchor" aria-label="anchor" href="#deprecated-and-defunct-1-4-0"></a></h3>
<ul><li>
<code>availableCores(method = "mc.cores")</code> is now defunct in favor of <code>"mc.cores+1"</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.3.0" id="version-130">Version 1.3.0<a class="anchor" aria-label="anchor" href="#version-130"></a></h2>
<div class="section level3">
<h3 id="new-features-1-3-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-3-0"></a></h3>
<ul><li><p><code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> treats workers that refer to a local machine by its local or canonical hostname as <code>"localhost"</code>. This avoids having to launch such workers over SSH, which may not be supported on all systems / compute cluster.</p></li>
<li><p>Added <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code>. By default it returns localhost workers according to <code><a href="../reference/availableCores.html">availableCores()</a></code>. In addition, it detects common HPC allocations given in environment variables set by the HPC scheduler.</p></li>
<li><p>Option <code>future.availableCores.fallback</code>, which defaults to environment variable <code>R_FUTURE_AVAILABLECORES_FALLBACK</code> can now be used to specify the default number of cores / workers returned by <code><a href="../reference/availableCores.html">availableCores()</a></code> and <code><a href="../reference/availableWorkers.html">availableWorkers()</a></code> when no other settings are available. For instance, if <code>R_FUTURE_AVAILABLECORES_FALLBACK=1</code> is set system wide in an HPC environment, then all R processes that uses <code><a href="../reference/availableCores.html">availableCores()</a></code> to detect how many cores can be used will run as single-core processes. Without this fallback setting, and without other core-specifying settings, the default will be to use all cores on the machine, which does not play well on multi-user systems.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-3-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-3-0"></a></h3>
<ul><li><p>Creation of cluster futures (including multisession ones) would time out already after 40 seconds if all workers were busy. New default timeout is 30 days (option <code>future.wait.timeout</code>).</p></li>
<li><p><code>availableCores(methods = "_R_CHECK_LIMIT_CORES_")</code> would give an error if not running <code>R CMD check</code>.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.2.0" id="version-120">Version 1.2.0<a class="anchor" aria-label="anchor" href="#version-120"></a></h2>
<div class="section level3">
<h3 id="new-features-1-2-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-2-0"></a></h3>
<ul><li><p>Added <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> - a version of <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makePSOCKcluster()</a></code> that allows for more flexible control of how PSOCK cluster workers are set up and how they are launched and communicated with if running on external machines.</p></li>
<li><p>Added generic <code><a href="../reference/as.cluster.html">as.cluster()</a></code> for coercing objects to cluster objects to be used as in <code>plan(cluster, workers = as.cluster(x))</code>. Also added a <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> implementation for cluster objects such that multiple cluster objects can be combined into a single one.</p></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-1-2-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-2-0"></a></h3>
<ul><li>Argument <code>user</code> to <code>remote()</code> was ignored (since 1.1.0).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1.1" id="version-111">Version 1.1.1<a class="anchor" aria-label="anchor" href="#version-111"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-1-1-1">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-1-1-1"></a></h3>
<ul><li>For the special case where ‘remote’ futures use <code>workers =    "localhost"</code> they (again) use the exact same R executable as the main / calling R session (in all other cases it uses whatever <code>Rscript</code> is found on the <code>PATH</code>). This was already indeed implemented in 1.0.1, but with the added support for reverse SSH tunnels in 1.1.0 this default behavior was lost.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1.0" id="version-110">Version 1.1.0<a class="anchor" aria-label="anchor" href="#version-110"></a></h2>
<div class="section level3">
<h3 id="new-features-1-1-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-1-1-0"></a></h3>
<ul><li>REMOTE CLUSTERS: It is now very simple to use <code>cluster()</code> and <code>remote()</code> to connect to remote clusters / machines. As long as you can connect via SSH to those machines, it works also with these future. The new code completely avoids incoming firewall and incoming port forwarding issues previously needed. This is done by using reverse SSH tunneling. There is also no need to worry about internal or external IP numbers.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.15.0" id="version-0150">Version 0.15.0<a class="anchor" aria-label="anchor" href="#version-0150"></a></h2>
<div class="section level3">
<h3 id="new-features-0-15-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-15-0"></a></h3>
<ul><li>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> also acknowledges environment variable <code>NSLOTS</code> set by Sun/Oracle Grid Engine (SGE).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.12.0" id="version-0120">Version 0.12.0<a class="anchor" aria-label="anchor" href="#version-0120"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-0-12-0">Bug Fixes<a class="anchor" aria-label="anchor" href="#bug-fixes-0-12-0"></a></h3>
<ul><li>FIX: Now <code><a href="../reference/availableCores.html">availableCores()</a></code> returns <code>3L</code> (=<code>2L+1L</code>) instead of <code>2L</code> if <code>_R_CHECK_LIMIT_CORES_</code> is set.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.10.0" id="version-0100">Version 0.10.0<a class="anchor" aria-label="anchor" href="#version-0100"></a></h2>
<div class="section level3">
<h3 id="new-features-0-10-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-10-0"></a></h3>
<ul><li>Now <code><a href="../reference/availableCores.html">availableCores()</a></code> also acknowledges the number of CPUs allotted by Slurm.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.8.0" id="version-080">Version 0.8.0<a class="anchor" aria-label="anchor" href="#version-080"></a></h2>
<div class="section level3">
<h3 id="new-features-0-8-0">New Features<a class="anchor" aria-label="anchor" href="#new-features-0-8-0"></a></h3>
<ul><li>
<code>availableCores("mc.cores")</code> returns <code>getOption("mc.cores") + 1L</code>, because option <code>mc.cores</code> specifies “allowed number of <em>additional</em> R processes” to be used in addition to the main R process.</li>
</ul></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer></div>





  </body></html>

