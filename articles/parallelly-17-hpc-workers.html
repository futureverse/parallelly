<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Parallel Workers on High-Performance Compute Environments • parallelly</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parallel Workers on High-Performance Compute Environments">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SB3EQSD9FR"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SB3EQSD9FR');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parallelly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.45.1-9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/parallelly-01-intro.html">An Introduction to 'parallelly'</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-10-local-workers.html">Parallel Workers on the Local Machine</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-12-remote-workers.html">Parallel Workers on Other Machines</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-15-cloud-workers.html">Parallel Workers in the Cloud</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-17-hpc-workers.html">Parallel Workers on High-Performance Compute Environments</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-20-limit-workers.html">Parallel Workers with CPU and Memory Limited</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-21-container-workers.html">Parallel Workers Running in Linux Containers</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-22-wine-workers.html">Parallel Workers Running MS Windows via Wine</a></li>
    <li><a class="dropdown-item" href="../articles/parallelly-25-sandbox-workers.html">Parallel Workers Running in a Sandbox</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.futureverse.org/"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages">
<li><a class="external-link dropdown-item" href="https://doFuture.futureverse.org">doFuture (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://furrr.futureverse.org">furrr (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.futureverse.org">future</a></li>
    <li><a class="external-link dropdown-item" href="https://future.apply.futureverse.org">future.apply (map-reduce)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.batchtools.futureverse.org">future.batchtools (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.callr.futureverse.org">future.callr (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mirai.futureverse.org">future.mirai (backend)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tests.futureverse.org">future.tests</a></li>
    <li><a class="external-link dropdown-item" href="https://globals.futureverse.org">globals</a></li>
    <li><a class="external-link dropdown-item" href="https://listenv.futureverse.org">listenv</a></li>
    <li><a class="dropdown-item" href="https://parallelly.futureverse.org">parallelly</a></li>
    <li><a class="external-link dropdown-item" href="https://progressr.futureverse.org">progressr</a></li>
    <li><a class="external-link dropdown-item" href="https://BiocParallel.FutureParam.futureverse.org">BiocParallel.FutureParam (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.tools.futureverse.org">future.tools (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://future.mapreduce.futureverse.org">future.mapreduce (experimental)</a></li>
    <li><a class="external-link dropdown-item" href="https://marshal.futureverse.org">marshal (experimental)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://cloud.r-project.org/package=parallelly"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/futureverse/parallelly/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Parallel Workers on High-Performance Compute Environments</h1>
                        <h4 data-toc-skip class="author">Henrik
Bengtsson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/futureverse/parallelly/blob/HEAD/vignettes/parallelly-17-hpc-workers.md" class="external-link"><code>vignettes/parallelly-17-hpc-workers.md</code></a></small>
      <div class="d-none name"><code>parallelly-17-hpc-workers.Rmd</code></div>
    </div>

    
    
<!--
%\VignetteIndexEntry{Parallel Workers on High-Performance Compute Environments}
%\VignetteAuthor{Henrik Bengtsson}
%\VignetteKeyword{R}
%\VignetteKeyword{package}
%\VignetteKeyword{vignette}
%\VignetteKeyword{HPC}
%\VignetteEngine{parallelly::selfonly}
-->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignettes illustrates how to launch parallel workers via job
schedulers running in high-performance compute (HPC) environments.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-launch-parallel-workers-via-the-grid-engine-job-scheduler">Example: Launch parallel workers via the Grid Engine job
scheduler<a class="anchor" aria-label="anchor" href="#example-launch-parallel-workers-via-the-grid-engine-job-scheduler"></a>
</h3>
<p>‘Grid Engine’ is a high-performance compute (HPC) job scheduler where
one can request compute resources on multiple nodes, each running
multiple cores. Examples of Grid Engine schedulers are Oracle Grid
Engine (formerly Sun Grid Engine), Univa Grid Engine, and Son of Grid
Engine - all commonly referred to as SGE schedulers. Each SGE cluster
may have its own configuration with their own way of requesting parallel
slots.</p>
<p>Consider the following two files: <code>script.sh</code> and
<code>script.R</code>.</p>
<p>script.sh:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#$ -cwd               ## Run in current working directory</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#$ -j y               ## Merge stdout and stderr</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#$ -l mem_free=100M   ## 100 MiB RAM per slot</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#$ -l h_rt=00:10:00   ## 10 minutes runtime </span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#$ -pe mpi 8          ## 8 compute slots</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Information on R:"</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">--version</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Running R script:"</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="ex">Rscript</span> script.R</span></code></pre></div>
<p>script.R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parallelly.futureverse.org">parallelly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/availableWorkers.html">availableWorkers</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rshcmd <span class="op">=</span> <span class="st">"qrsh"</span>, rshopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-inherit"</span>, <span class="st">"-nostdin"</span>, <span class="st">"-V"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform calculations in parallel</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parLapply</a></span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, <span class="va">X</span>, fun <span class="op">=</span> <span class="va">sqrt</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>The <code>script.sh</code> file is a job script that we submit to the
scheduler that runs the R script <code>script.R</code> when launched. If
we submit <code>script.sh</code> as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> qsub script.sh</span></code></pre></div>
<p>it will by default request eight slots - on one more more machines,
which then R and <strong>parallelly</strong> will set up a parallel
cluster on. On how many, and on which machines, the parallel workers
will run on depends on where the job scheduler finds these requested
slots on.</p>
<p>Here is the output from one such run, where the scheduler happened to
allot the slots across three machines:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">Information</span> on R:</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">Rscript</span> <span class="er">(</span><span class="ex">R</span><span class="kw">)</span> <span class="ex">version</span> 4.5.1 <span class="er">(</span><span class="ex">2025-06-13</span><span class="kw">)</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">Running</span> R script:</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">Socket</span> cluster with 8 nodes where 4 nodes are on host ‘localhost’</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="kw">(</span><span class="ex">R</span> version 4.5.1 <span class="er">(</span><span class="ex">2025-06-13</span><span class="kw">)</span><span class="ex">,</span> platform x86_64-pc-linux-gnu<span class="kw">)</span><span class="ex">,</span> 3</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="ex">nodes</span> are on host ‘qb3-id130’ <span class="er">(</span><span class="ex">R</span> version 4.5.1 <span class="er">(</span><span class="ex">2025-06-13</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ex">platform</span> x86_64-pc-linux-gnu<span class="kw">)</span><span class="ex">,</span> 1 node is on host ‘qb3-as16’ <span class="er">(</span><span class="ex">R</span> </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="ex">version</span> 4.5.1 <span class="er">(</span><span class="ex">2025-06-13</span><span class="kw">)</span><span class="ex">,</span> platform x86_64-pc-linux-gnu<span class="kw">)</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="ex">[1]</span> 671.4629</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-launch-parallel-workers-via-thefujitsu-technical-computing-suite-job-scheduler">Example: Launch parallel workers via the’Fujitsu Technical Computing
Suite job scheduler<a class="anchor" aria-label="anchor" href="#example-launch-parallel-workers-via-thefujitsu-technical-computing-suite-job-scheduler"></a>
</h3>
<p>The ‘Fujitsu Technical Computing Suite’ is a high-performance compute
(HPC) job scheduler where one can request compute resources on multiple
nodes, each running multiple cores.</p>
<p>Consider the following two files: <code>script.sh</code> and
<code>script.R</code>.</p>
<p>script.sh:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Information on R:"</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">--version</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Running R script:"</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">Rscript</span> script.R</span></code></pre></div>
<p>script.R:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parallelly.futureverse.org">parallelly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/availableWorkers.html">availableWorkers</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rshcmd <span class="op">=</span> <span class="st">"pjrsh"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform calculations in parallel</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parLapply</a></span><span class="op">(</span>cl <span class="op">=</span> <span class="va">cl</span>, <span class="va">X</span>, fun <span class="op">=</span> <span class="va">sqrt</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre></div>
<p>The <code>script.sh</code> file is a job script that we submit to the
scheduler that runs the R script <code>script.R</code> when launched.
Wee can submit <code>script.sh</code> as:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> pjsub <span class="at">-L</span> vnode=3 <span class="at">-L</span> vnode-core=18 script.sh</span></code></pre></div>
<p>to request 18 CPU cores on three compute nodes, which in total
requests 3*18=54 compute slots.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

    </footer>
</div>





  </body>
</html>
