<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>parallelly: Parallel workers on other machines • parallelly</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="parallelly: Parallel workers on other machines">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-SB3EQSD9FR"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SB3EQSD9FR');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parallelly</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.39.0-9026</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/parallelly-01-intro.html">parallelly: An Introduction</a>
    </li>
    <li>
      <a href="../articles/parallelly-11-limit-workers.html">parallelly: Limit CPU and memory for parallel workers</a>
    </li>
    <li>
      <a href="../articles/parallelly-12-remote-workers.html">parallelly: Parallel workers on other machines</a>
    </li>
    <li>
      <a href="../articles/parallelly-15-cloud-workers.html">parallelly: Parallel workers in the cloud</a>
    </li>
    <li>
      <a href="../articles/parallelly-21-container-workers.html">parallelly: Parallel workers running in Linux Containers</a>
    </li>
    <li>
      <a href="../articles/parallelly-22-wine-workers.html">parallelly: Parallel workers running MS Windows via Wine</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.futureverse.org/" class="external-link">
    <span class="fas fa-home"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Packages

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://doFuture.futureverse.org" class="external-link">doFuture (map-reduce)</a>
    </li>
    <li>
      <a href="https://furrr.futureverse.org" class="external-link">furrr (map-reduce)</a>
    </li>
    <li>
      <a href="https://future.futureverse.org" class="external-link">future</a>
    </li>
    <li>
      <a href="https://future.apply.futureverse.org" class="external-link">future.apply (map-reduce)</a>
    </li>
    <li>
      <a href="https://future.batchtools.futureverse.org" class="external-link">future.batchtools (backend)</a>
    </li>
    <li>
      <a href="https://future.callr.futureverse.org" class="external-link">future.callr (backend)</a>
    </li>
    <li>
      <a href="https://future.mirai.futureverse.org" class="external-link">future.mirai (backend)</a>
    </li>
    <li>
      <a href="https://future.tests.futureverse.org" class="external-link">future.tests</a>
    </li>
    <li>
      <a href="https://globals.futureverse.org" class="external-link">globals</a>
    </li>
    <li>
      <a href="https://listenv.futureverse.org" class="external-link">listenv</a>
    </li>
    <li>
      <a href="https://parallelly.futureverse.org">parallelly</a>
    </li>
    <li>
      <a href="https://progressr.futureverse.org" class="external-link">progressr</a>
    </li>
    <li>
      <a href="https://BiocParallel.FutureParam.futureverse.org" class="external-link">BiocParallel.FutureParam (experimental)</a>
    </li>
    <li>
      <a href="https://future.tools.futureverse.org" class="external-link">future.tools (experimental)</a>
    </li>
    <li>
      <a href="https://future.mapreduce.futureverse.org" class="external-link">future.mapreduce (experimental)</a>
    </li>
    <li>
      <a href="https://marshal.futureverse.org" class="external-link">marshal (experimental)</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://cloud.r-project.org/package=parallelly" class="external-link">
    <span class="fab fa-r-project"></span>

  </a>
</li>
<li>
  <a href="https://github.com/futureverse/parallelly/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>

    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>parallelly: Parallel workers on other
machines</h1>
                        <h4 data-toc-skip class="author">Henrik
Bengtsson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/futureverse/parallelly/blob/HEAD/vignettes/parallelly-12-remote-workers.md" class="external-link"><code>vignettes/parallelly-12-remote-workers.md</code></a></small>
      <div class="hidden name"><code>parallelly-12-remote-workers.md</code></div>

    </div>

    
    
<!--
%\VignetteIndexEntry{parallelly: Parallel workers on other machines}
%\VignetteAuthor{Henrik Bengtsson}
%\VignetteKeyword{R}
%\VignetteKeyword{package}
%\VignetteKeyword{vignette}
%\VignetteEngine{parallelly::selfonly}
-->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Sometimes it is not sufficient to parallization on a single computer
- it cannot provide all of the compute power we are looking for. When we
hit this limit, a natural next level is to look at other computers near
us, e.g. desktops in an office or other computers we have access to
remotely. In this vignette, we will cover how to run parallel R workers
on other machines. Sometimes we distingush between local machines and on
remote machines, where <em>local</em> machines are machines considered
to be on the same local area network (LAN) and that might share a common
file system. <em>Remote</em> machines are machines that are on a
different network and that do not share a common file system with the
main R computer. In most cases the distinction between local and remote
machines does not matter, but in some cases we can take advantages of
workers being local.</p>
<p>Regardless of running parallel workers on local or remote machines,
we need a way to connect to the machines and launch R on them.</p>
<div class="section level3">
<h3 id="ssh-and-r-configuration-once">SSH and R configuration (once)<a class="anchor" aria-label="anchor" href="#ssh-and-r-configuration-once"></a>
</h3>
<div class="section level4">
<h4 id="verifying-ssh-access">Verifying SSH access<a class="anchor" aria-label="anchor" href="#verifying-ssh-access"></a>
</h4>
<p>The most common approach to connect to another machine is via Secure
Shell (SSH). Linux, macOS, and MS Windows all have a built-in SSH client
called <code>ssh</code>. Consider we have another Linux machine called
<code>n1.remote.org</code>, it can be accessed via SSH, and we have an
account <code>alice</code> on that machine. For the case of these
instructions, it does not matter whether <code>n1.remote.org</code> is
on our local network (LAN) or a remote machine on the internet. Also, to
make it clear that we do not have to have the same username on
<code>n1.remote.org</code> and on our local machine, we will use
<code>ally</code> as the username on our local machine.</p>
<p>To access the <code>alice</code> user account on
<code>n1.remote.org</code> from our local computer, we open a terminal
on the local computer and then SSH to the other machine as:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh alice@n1.remote.org</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">alice@n1.remote.org</span><span class="st">'s password: *************</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="st">{alice@n1}$ </span></span></code></pre></div>
<p>The commands to call are what follows after the prompt. The prompt on
our local machine is <code>{ally@local}$</code>, which tells us that our
username is <code>ally</code> and the name of the local machine is
<code>local</code>. The prompt on the <code>n1.remote.org</code> machine
is <code>{alice@n1}$</code>, which tells us that our username on that
machine is <code>alice</code> and that the machine is called
<code>n1</code> on that system.</p>
<p>To return to our local machine, exit the SSH shell by typing
<code>exit</code>;</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">{alice@n1}$</span> exit</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">{ally@local}$</span> </span></code></pre></div>
<p>If we get this far, we have confirmed that we have SSH access to this
machine.</p>
</div>
<div class="section level4">
<h4 id="configure-password-less-ssh-access">Configure password-less SSH access<a class="anchor" aria-label="anchor" href="#configure-password-less-ssh-access"></a>
</h4>
<p>Launching parallel R workers is typically done automatically in the
background, which means it cumbersome, or even impossible, to enter the
SSH password for each machine we wish to connect to. The solution is to
configure SSH to connect with <em>public-private keys</em>, which
pre-establish SSH authentication between the main machine and the
machine to connect to. As this is common practice when working with SSH,
there are numerous online tutorial explaining how to configure
private-public SSH key pairs. Please consult one of them for the
details, but the gist is to use (i) <code>ssh-keygen</code> to generate
the public-private SSH keys on your local machine, and then (ii)
<code>ssh-copy-id</code> to deploy the public key on the machine you
want to connect to.</p>
<p>Step 1: Generate public-private SSH keys locally</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh-keygen</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">Generating</span> public/private rsa key pair.</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">Enter</span> file in which to save the key <span class="er">(</span><span class="ex">/home/ally/.ssh/id_rsa</span><span class="kw">)</span><span class="bu">:</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">Created</span> directory <span class="st">'/home/ally/.ssh'</span>.</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">Enter</span> passphrase <span class="er">(</span><span class="ex">empty</span> for no passphrase<span class="kw">)</span><span class="bu">:</span> </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">Enter</span> same passphrase again: </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">Your</span> identification has been saved in /home/ally/.ssh/id_rsa</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="ex">Your</span> public key has been saved in /home/ally/.ssh/id_rsa.pub</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="ex">The</span> key fingerprint is:</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="ex">SHA256:Sx48uXZTUL12SKKUzWB77e/Pm3TifqrDIbOnJ0pEWHY</span> ally@local</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="ex">The</span> key<span class="st">'s randomart image is:</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="st">+---[RSA 3072]----+</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="st">|        o E=..   |</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="st">|       + ooo+.o  |</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="st">|      . ..o..o.o |</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="st">|       o ..o .+ .|</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="st">|        S   .... |</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="st">|       + =o..  . |</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="st">|        * o= ...o|</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="st">|       o .o.=..++|</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="st">|        ...=.++=*|</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="st">+----[SHA256]-----+</span></span></code></pre></div>
<p>Step 2: Copy the public SSH key to the other machine</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh-copy-id alice@n1.remote.org</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">/usr/bin/ssh-copy-id:</span> INFO: Source of key<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">to</span> be installed: <span class="st">"/home/ally/.ssh/id_rsa.pub"</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">/usr/bin/ssh-copy-id:</span> INFO: attempting to log in with the new key<span class="er">(</span><span class="ex">s</span><span class="kw">)</span><span class="ex">,</span> to filter out any that are already installed</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">/usr/bin/ssh-copy-id:</span> INFO: 1 key<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">remain</span> to be installed <span class="at">--</span> if you are prompted now it is to install the new keys</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="ex">alice@n1.remote.org:s</span> password: <span class="pp">*************</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ex">Number</span> of key<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">added:</span> 1</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="ex">Now</span> try logging into the machine, with:   <span class="st">"ssh 'alice@n1.remote.org'"</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="ex">and</span> check to make sure that only the key<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">you</span> wanted were added.</span></code></pre></div>
<p>At this point, we should be able to SSH to the other machine without
having to enter a password;</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh alice@n1.remote.org</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">{alice@n1}$</span></span></code></pre></div>
<p>Type <code>exit</code> to return to your local machine.</p>
<p>Note, if you later want to connect to other machines,
e.g. <code>n2.remote.org</code> or <code>hpc.my-university.edu</code>,
you may re-use the above generated keys for those systems to. In other
words, you do not have to use <code>ssh-keygen</code> to generate new
keys for those machines.</p>
</div>
<div class="section level4">
<h4 id="verifying-r-exists-on-the-other-machine">Verifying R exists on the other machine<a class="anchor" aria-label="anchor" href="#verifying-r-exists-on-the-other-machine"></a>
</h4>
<p>In order to run parallel R workers on another machine, it (i) needs
to be installed on that machine, and (ii) ideally readily available by
calling <code>Rscript</code>. Parallel R workers are launched via
<code>Rscript</code>, instead of the more commonly known <code>R</code>
command - both come with all R installation, i.e. if you have one of
them, you have the other too.</p>
<p>To verify that R is installed on the other machine, SSH to the
machine and call <code>Rscript --version</code>;</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh alice@n1.remote.org</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="ex">{alice@n1}$</span> Rscript <span class="at">--version</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="ex">Rscript</span> <span class="er">(</span><span class="ex">R</span><span class="kw">)</span> <span class="ex">version</span> 4.4.2 <span class="er">(</span><span class="ex">2024-10-31</span><span class="kw">)</span></span></code></pre></div>
<p>If you get:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">{alice@n1}$</span> Rscript <span class="at">--version</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">Rscript:</span> command not found</span></code></pre></div>
<p>then R is either not installed on that machine, or it cannot be
found. If it is installed, but cannot be found, make sure that
environment variable <code>PATH</code> his configured properly on that
machine.</p>
</div>
<div class="section level4">
<h4 id="final-checks">Final checks<a class="anchor" aria-label="anchor" href="#final-checks"></a>
</h4>
<p>With password-less SSH access, and R being available, on the other
machine, we should be able to SSH into the other machine and query the R
version in a single call:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh alice@n1.remote.org Rscript <span class="at">--version</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">Rscript</span> <span class="er">(</span><span class="ex">R</span><span class="kw">)</span> <span class="ex">version</span> 4.4.2 <span class="er">(</span><span class="ex">2024-10-31</span><span class="kw">)</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="ex">{ally@local}$</span></span></code></pre></div>
<p>This is all that is needed to launch one or more parallel R workers
on machine <code>n1.remote.org</code> running under user
<code>alice</code>. When can test this from within R with the
<strong>parallelly</strong> package using:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> R <span class="at">--quiet</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">parallely</span><span class="kw">)</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="ex">cl</span> <span class="op">&lt;</span>- makeClusterPSOCK<span class="er">(</span><span class="st">"n1.remote.org"</span><span class="ex">,</span> user = <span class="st">"alice"</span><span class="kw">)</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="ex">print</span><span class="er">(</span><span class="ex">cl</span><span class="kw">)</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; Socket cluster with 1 nodes where 1 node is on host 'n1.remote.org'</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu)</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="ex">parallel::stopCluster</span><span class="er">(</span><span class="ex">cl</span><span class="kw">)</span></span></code></pre></div>
<p>If you want to run parallel workers on other machines, repeat the
above for each machine. After this, you will be able to launch parallel
R workers on these machines with little efforts.</p>
</div>
<div class="section level4">
<h4 id="machine-specific-ssh-customization-recommended">Machine-specific SSH customization (recommended)<a class="anchor" aria-label="anchor" href="#machine-specific-ssh-customization-recommended"></a>
</h4>
<p>Some machines do not use the default port 22 to answer on SSH
connection requests. If the machine uses another port, say, port 2201,
then we canspecify that via option <code>-p port</code>, when we connect
to it, e.g.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh <span class="at">-p</span> 2201 alice@n1.remote.org</span></code></pre></div>
<p>In R, we can specify argument <code>port=port</code> as in:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">cl</span> <span class="op">&lt;</span>- makeClusterPSOCK<span class="er">(</span><span class="st">"n1.remote.org"</span><span class="ex">,</span> port = 2201, user = <span class="st">"alice"</span><span class="kw">)</span></span></code></pre></div>
<p>Now, it can be tedious to have to remember custom SSH ports and
usernames when setting up remote workers in R. It also adds noise and
distraction having such details in the R script, and not to mention the
fact that the R script has a specific username hardcoded into the code
makes the script less reproducible for other users - they need to change
the code to match their username. One way to avoid having to give
specific SSH options when calling <code>ssh</code> in the terminal, or
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> in R, is to configure these settings in
SSH. This can be done via a file called <code>~/.ssh/config</code>
<em>on your local machine</em>. This file does not exist by default, so
you would have to create it yourself, if missing. It is a plain text
file, so you should use a plain text editor to create and edit it.</p>
<p>To configure SSH to use port 2201 and username <code>alice</code>
whenever connecting to <code>n1.remote.org</code>, the
<code>~/.ssh/config</code> file should contain the following entry:</p>
<pre class="plain"><code>Host n1.remote.org
  User alice
  Port 2201</code></pre>
<p>With this, we can connect to <code>n1.remote.org</code> just
using:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh n1.remote.org</span></code></pre></div>
<p>SSH will then connect to the machine as if we had specified also
<code>-p 2201</code> and <code>-l alice</code>. These settings will also
be picked up when we connect via R, meaning the following will also
work:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">cl</span> <span class="op">&lt;</span>- makeClusterPSOCK<span class="er">(</span><span class="st">"n1.remote.org"</span><span class="kw">)</span></span></code></pre></div>
<p>To achieve the same for other machines, add another entry for them,
e.g.</p>
<pre class="plain"><code>Host n1.remote.org
  User alice
  Port 2201

Host n2.remote.org
  User alice
  Port 2201

Host hpc.my-university.edu
  User alice.bobson</code></pre>
<p>When hosts on the same system share the same setting, one can use
globbing to configure them the same way. For instance, the above can be
shorted to:</p>
<pre class="plain"><code>Host n?.remote.org
  User alice
  Port 2201

Host hpc.my-university.edu
  User alice.bobson</code></pre>
<p>Being able to connect to remote machines by just specifying their
hostnames is convenient and simplies also the R code. Because of this,
we recommend setting up also <code>~/.ssh/config</code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-two-parallel-workers-on-a-single-remote-machine">Example: Two parallel workers on a single remote machine<a class="anchor" aria-label="anchor" href="#example-two-parallel-workers-on-a-single-remote-machine"></a>
</h3>
<p>Our first example sets up two parallel workers on the remote machine
<code>n1.remote.org</code>. For this to work, we need SSH access to the
machine, and it must have R installed, as explained in the above
section. Contrary to local parallel workers, the number of parallel
workers on remote machines is specified by repeating the machine name an
equal number of times;</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parallelly.futureverse.org">parallelly</a></span><span class="op">)</span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1.remote.org"</span>, <span class="st">"n1.remote.org"</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span>, user <span class="op">=</span> <span class="st">"alice"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Socket cluster with 2 nodes where 2 nodes are on host 'n1.remote.org'</span></span>
<span><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu).</span></span></code></pre></div>
<p><em>Comment</em>: In the <strong>parallel</strong> package, a
parallel worker is referred to a parallel node, or short <em>node</em>,
which is why we use the same term in the <strong>parallelly</strong>
package.</p>
<p>Note, contrary to parallel workers running on the local machine,
parallel workers on remote machines are launched sequentially, that is
one after each other. Because of this, the setup time for a remote
parallel cluster will increase linearly with the number of remote
parallel workers.</p>
<p><em>Technical details</em>: If we would add
<code>verbose = TRUE</code> to <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code>, we would
learn that the parallel workers are launched in the background by R
using something like:</p>
<pre><code>'/usr/bin/ssh' -R 11058:localhost:11058 -l alice n1.remote.org Rscript ...
'/usr/bin/ssh' -R 11059:localhost:11059 -l alice n1.remote.org Rscript ...</code></pre>
<p>This tells us that there is one active SSH connection per parallel
worker. It also reveals that that each of these connections uses a so
called <em>reverse tunnel</em>, which is used to establish a unique
communication channel between the main R process and the correponding
parallel worker. It also this use of reverse tunneling that avoids
having to configure dynamic DNS (DDNS) and port-forwarding in our local
firewalls, which is cumbersome and requires administrative rights. When
using <strong>parallelly</strong>, there is no need for administrative
rights - any non-priviliged user can launch remote parallel R
workers.</p>
</div>
<div class="section level3">
<h3 id="example-two-parallel-workers-on-two-remote-machines">Example: Two parallel workers on two remote machines<a class="anchor" aria-label="anchor" href="#example-two-parallel-workers-on-two-remote-machines"></a>
</h3>
<p>This example sets up a parallel worker on each of two remote machines
<code>n1.remote.org</code> and <code>n2.remote.org</code>. It works very
similar to the previous example, but now the two SSH connections go to
two different machiens rather than the same.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parallelly.futureverse.org">parallelly</a></span><span class="op">)</span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1.remote.org"</span>, <span class="st">"n2.remote.org"</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span>, user <span class="op">=</span> <span class="st">"alice"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Socket cluster with 2 nodes where 1 node is on host 'n1.remote.org'</span></span>
<span><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu), </span></span>
<span><span class="co">#&gt; 1 node is on host 'n2.remote.org' (R version 4.4.2 (2024-10-31),</span></span>
<span><span class="co">#&gt; platform x86_64-pc-linux-gnu)</span></span></code></pre></div>
<p><em>Technical details</em>: If we would add
<code>verbose = TRUE</code> also in this case, we would see:</p>
<pre><code>'/usr/bin/ssh' -R 11464:localhost:11464 -l alice n1.remote.org Rscript ...
'/usr/bin/ssh' -R 11465:localhost:11464 -l alice n2.remote.org Rscript ...</code></pre>
<p>Recall, if we have configured SSH to pick up the username
<code>alice</code> from <code>~/.ssh/config</code> on our local machine,
as shown in the previous section, we could have skipped the
<code>user</code> argument, and just used:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1.remote.org"</span>, <span class="st">"n2.remote.org"</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span><span class="op">)</span></span></code></pre></div>
<p>Note how these instructions for setting up a parallel cluster on
these two machines would be the identical for another user that has
configured their personal <code>~/.ssh/config</code> file.</p>
</div>
<div class="section level3">
<h3 id="example-three-parallel-workers-on-two-remote-machines">Example: Three parallel workers on two remote machines<a class="anchor" aria-label="anchor" href="#example-three-parallel-workers-on-two-remote-machines"></a>
</h3>
<p>When we now understand that we control the number of parallel workers
on a specific machine by replicate the machine name, we also know how to
launch different number of parallel workers on different machines. From
now on, we will also assume that the remote username no longer has to be
specified, because it has already been configured via the
<code>~/.ssh/config</code> file. With this, we can sets up two parallel
workers on <code>n1.remote.org</code> and one on
<code>n2.remote.org</code>, by:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parallelly.futureverse.org">parallelly</a></span><span class="op">)</span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n1.remote.org"</span>, <span class="st">"n1.remote.org"</span>, <span class="st">"n2.remote.org"</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Socket cluster with 3 nodes where 2 nodes are on host 'n1.remote.org'</span></span>
<span><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu), </span></span>
<span><span class="co">#&gt; 1 node is on host 'n2.remote.org' (R version 4.4.2 (2024-10-31),</span></span>
<span><span class="co">#&gt; platform x86_64-pc-linux-gnu)</span></span></code></pre></div>
<p>Again, the <code>user</code> argument does not have to be specified,
because it is configured in <code>~/.ssh/config</code>.</p>
<p>To generalize to many workers, we can use the <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code>
function. For example,</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"n1.remote.org"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"n2.remote.org"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>sets up three workers on <code>n1.remote.org</code> and four on
<code>n2.remote.org</code>, totaling seven parallel workers.</p>
</div>
<div class="section level3">
<h3 id="example-a-mix-of-local-and-remote-workers">Example: A mix of local and remote workers<a class="anchor" aria-label="anchor" href="#example-a-mix-of-local-and-remote-workers"></a>
</h3>
<p>As an alternative to <code>makeClusterPSOCK(n)</code>, we can use
<code>makeClusterPSOCK(workers)</code> to set up parallelly workers
running on the local machine. By convention, the name
<code>localhost</code> is an alias to your local machine. This means, we
can use:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">parallelly</span><span class="kw">)</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="ex">workers</span> <span class="op">&lt;</span>- rep<span class="er">(</span><span class="st">"localhost"</span><span class="ex">,</span> 4<span class="kw">)</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="ex">cl_local</span> <span class="op">&lt;</span>- makeClusterPSOCK<span class="er">(</span><span class="ex">workers</span><span class="kw">)</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="ex">print</span><span class="er">(</span><span class="ex">cl_local</span><span class="kw">)</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; Socket cluster with 4 nodes where 4 nodes are on host 'localhost'</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu)</span></span></code></pre></div>
<p>to launch four local parallel workers. Note how we did not have to
specify <code>user = "ally"</code>. This is because the default username
is always the local username. Next, assume we want to add another four
parallel workers running on <code>n1.remote.org</code>. We already know
we can set these up as:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">parallelly</span><span class="kw">)</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="ex">workers</span> <span class="op">&lt;</span>- rep<span class="er">(</span><span class="st">"n1.remote.org"</span><span class="ex">,</span> 4<span class="kw">)</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="ex">cl_remote</span> <span class="op">&lt;</span>- makeClusterPSOCK<span class="er">(</span><span class="ex">workers,</span> user = <span class="st">"alice"</span><span class="kw">)</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="ex">print</span><span class="er">(</span><span class="ex">cl_remote</span><span class="kw">)</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt; Socket cluster with 4 nodes where 4 nodes are on host 'n1.remote.org'</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu).</span></span></code></pre></div>
<p>At this point, we have two independent clusters of parallel workers:
<code>cl_local</code> and <code>cl_remote</code>. We can combine them
into a single cluster using:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cl_local</span>, <span class="va">cl_remote</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">#&gt; Socket cluster with 8 nodes where 4 nodes are on host 'localhost'</span></span>
<span><span class="co">#&gt; (R version 4.4.2 (2024-10-31), platform x86_64-pc-linux-gnu), 4</span></span>
<span><span class="co">#&gt; nodes are on host 'n1.remote.org' (R version 4.4.2 (2024-10-31),</span></span>
<span><span class="co">#&gt; platform x86_64-pc-linux-gnu)</span></span></code></pre></div>
<p>To emphasize the usefulness of customizing our SSH connections via
<code>~/.ssh/config</code>, if the remote username would already have
been already configured there, we would be able to set up the full
cluster in one single call, as in:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="ex">library</span><span class="er">(</span><span class="ex">parallelly</span><span class="kw">)</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="ex">workers</span> <span class="op">&lt;</span>- c<span class="er">(</span><span class="ex">rep</span><span class="er">(</span><span class="st">"localhost"</span><span class="ex">,</span> 4<span class="kw">)</span><span class="ex">,</span> rep<span class="er">(</span><span class="st">"n1.remote.org"</span><span class="ex">,</span> 4<span class="kw">)</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="ex">cl</span> <span class="op">&lt;</span>- makeClusterPSOCK<span class="er">(</span><span class="ex">workers</span><span class="kw">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-parallel-workers-on-a-remote-machine-accessed-via-dedicated-login-machine">Example: Parallel workers on a remote machine accessed via dedicated
login machine<a class="anchor" aria-label="anchor" href="#example-parallel-workers-on-a-remote-machine-accessed-via-dedicated-login-machine"></a>
</h3>
<p>Sometimes a remote machine, where we want to run R, is only
accessible via an intermediate login machine, which in SSH terms may
also be referred to as a “jumphost”. For example, assume machine
<code>secret1.remote.org</code> can only be accessed by first logging
into <code>login.remote.org</code> as in:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh alice@login.remote.org</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="ex">{alice@login}$</span> ssh alice@secret1.remote.org</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="ex">{alice@secret1}$</span> </span></code></pre></div>
<p>To achive the same in a single SSH call, we can specify the
“jumphost” <code>-J hostname</code> option for SSH, as in:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh <span class="at">-J</span> alice@login.remote.org alice@secret1.remote.org</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="ex">{alice@secret1}$</span> </span></code></pre></div>
<p>We can use the <code>rshopts</code> argument of
<code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> to achieve the same when setting up
parallel workers. To launch three parallel workers on
<code>secret1.remote.org</code>, use:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"secret1.remote.org"</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span></span>
<span>  <span class="va">workers</span>,</span>
<span>  rshopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-J"</span>, <span class="st">"login.remote.org"</span><span class="op">)</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"alice"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A more convenient solution is to configure the jumphost in
<code>~/.ssh/config</code>, as in:</p>
<pre class="plain"><code>Host *.remote.org
  User alice

Host secret?.remote.org
  ProxyJump login.remote.org</code></pre>
<p>This will cause any SSH connection to a machine on the
<code>remote.org</code> network to use username <code>alice</code>. It
will also cause any SSH connection to machines
<code>secret1.remote.org</code>, <code>secret2.remote.org</code>, and so
on, to use jumphost <code>login.remote.org</code>. You can verify that
all this work by:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh login.remote.org</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="ex">{alice@login}$</span></span></code></pre></div>
<p>and then:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="ex">{ally@local}$</span> ssh secret1.remote.org</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="ex">{alice@n1}$</span> </span></code></pre></div>
<p>If the above work, then the following will work from within R:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://parallelly.futureverse.org">parallelly</a></span><span class="op">)</span></span>
<span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"secret1.remote.org"</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="special-needs-and-tweaks">Special needs and tweaks<a class="anchor" aria-label="anchor" href="#special-needs-and-tweaks"></a>
</h2>
<p>The above sections cover most common use cases for setting up a
parallel cluster from a local Linux, macOS, and MS Windows machine.
However, there are cases where there above does not work, or you prefer
to use another solution. This section aims to cover such
alternatives.</p>
<div class="section level3">
<h3 id="example-remote-workers-ignoring-any-remote--rprofile-settings">Example: Remote workers ignoring any remote .Rprofile settings<a class="anchor" aria-label="anchor" href="#example-remote-workers-ignoring-any-remote--rprofile-settings"></a>
</h3>
<p>To launch parallel workers skipping any <code>~/.Rprofile</code>
settings on the remote machines, we can pass option
<code>--no-init-file</code> to <code>Rscript</code> via argument
<code>rscript_args</code>. For example,</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"n1.remote.org"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span>, rscript_args <span class="op">=</span> <span class="st">"--no-init-file"</span><span class="op">)</span></span></code></pre></div>
<p>will launch two parallel workers on <code>n1.remote.org</code>
ignoring any <code>.Rprofile</code> files.</p>
</div>
<div class="section level3">
<h3 id="example-use-putty-on-ms-windows-to-connect-to-remote-worker">Example: Use PuTTY on MS Windows to connect to remote worker<a class="anchor" aria-label="anchor" href="#example-use-putty-on-ms-windows-to-connect-to-remote-worker"></a>
</h3>
<p>If you run on an MS Windows machine and prefer to use PuTTY to manage
your SSH connections, or for other reasons cannot use the built-in
<code>ssh</code> client, you can tell <code><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK()</a></code> to
use PuTTY and your PuTTY settings via various arguments.</p>
<p>Here is an example that launches two parallel workers on
<code>n1.remote.org</code> running under user <code>alice</code>
connecting via SSH port 2201 using PuTTY and public-private SSH keys in
file <code>C:/Users/ally/.ssh/putty.ppk</code>:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="st">"n1.remote.org"</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span></span>
<span>  <span class="va">workers</span>, </span>
<span>  user <span class="op">=</span> <span class="st">"alice"</span>,</span>
<span>  rshcmd <span class="op">=</span> <span class="st">"&lt;putty-plink&gt;"</span>,</span>
<span>  rshopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-P"</span>, <span class="fl">2201</span>, <span class="st">"-i"</span>, <span class="st">"C:/Users/ally/.ssh/putty.ppk"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-two-remote-workers-running-on-ms-windows">Example: Two remote workers running on MS Windows<a class="anchor" aria-label="anchor" href="#example-two-remote-workers-running-on-ms-windows"></a>
</h3>
<p>Thus far we have considered our remote machines to run a Unix-like
operating system, e.g. Linux or macOS. If your remote machines run MS
Windows, you can use similar techniques to launch parallel workers there
as well. For this to work, the remote MS Windows machines must accept
incoming SSH connections, which is something most Windows machines are
not configured to do by default. If you do not know set that up, or if
you do not have the system permissions to do so, please reach out to you
system administrator of those machines.</p>
<p>Assuming we have SSH access to two MS Windows machines,
<code>mswin1.remote.org</code> and <code>mswin2.remote.org</code>,
everything works the same as before, except that we need to also specify
also argument <code>rscript_sh = "cmd"</code>;</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mswin1.remote.org"</span>, <span class="st">"mswin2.remote.org"</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeClusterPSOCK.html">makeClusterPSOCK</a></span><span class="op">(</span><span class="va">workers</span>, rscript_sh <span class="op">=</span> <span class="st">"cmd"</span><span class="op">)</span></span></code></pre></div>
<p>That argument specifies that the parallel R workers should be
launched on the remote machines via MS Windows’ <code>cmd.exe</code>
shell.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Henrik Bengtsson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1</p> and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9007.</p>
</div>

      </footer>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: 'aa6e02fc501886fb0f7c91ac4e300456',
    indexName: 'futureverse',
    algoliaOptions: { 'facetFilters': ['project:parallelly'] },
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
